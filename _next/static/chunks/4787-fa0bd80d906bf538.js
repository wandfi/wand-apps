(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4787],{79391:function(){},51830:function(e,t,n){"use strict";n.d(t,{Z:function(){return ConnectBtn}});var a=n(52628),u=n(3178),l=n(44726),o=n(6951),s=n(70475);function ConnectBtn(){(0,l.Z)(1024);let{isConnected:e,chainId:t}=(0,o.m)(),n=(0,u.We)();return e?(0,a.jsx)(u.NL,{chainStatus:"none",showBalance:!1}):(0,a.jsx)(s.k6,{className:"mt-0 w-fit",onClick:()=>{var e;return null===(e=n.openConnectModal)||void 0===e?void 0:e.call(n)},children:(0,a.jsx)("span",{className:"font-medium text-sm px-5 whitespace-nowrap",children:"Connect Wallet"})})}},83084:function(e,t,n){"use strict";n.d(t,{C:function(){return Tip}});var a=n(52628),u=n(15493),l=n(52653),o=n(55966);function Tip(e){let{children:t,node:n,className:s,inFlex:r,contentClassName:c}=e,i=document.getElementById("tooltip-root");return t?(0,a.jsx)(l.zt,{children:(0,a.jsxs)(l.fC,{children:[(0,a.jsx)(l.xz,{asChild:!0,onClickCapture:e=>{e.preventDefault(),e.stopPropagation()},children:n?(0,a.jsx)("div",{className:(0,u.cn)("inline-block cursor-default",s),style:{verticalAlign:"text-bottom"},children:n}):(0,a.jsx)("div",{className:(0,u.cn)(r?"flex":"translate-y-[-6%] inline-block"," px-[3px] cursor-default relative",s),children:(0,a.jsx)(o.apP,{className:"inline-block stroke-slate-500"})})}),(0,a.jsx)(l.h_,{container:i,children:(0,a.jsxs)(l.VY,{className:(0,u.cn)("max-w-xs text-sm text-white bg-slate-900 shadow-lg dark:bg-[#333333] rounded-md p-4",c),children:[t,(0,a.jsx)(l.Eh,{})]})})]})}):n}},25495:function(e,t,n){"use strict";n.d(t,{b:function(){return useMemoOfChainId}});var a=n(83508),u=n(90947);function useMemoOfChainId(e){let t=(0,u.p)(),n=(0,a.useRef)({});return(0,a.useMemo)(()=>(n.current[t]||(n.current[t]=e()),n.current[t]),[t])}},11944:function(e,t,n){"use strict";n.d(t,{i:function(){return i},p:function(){return useUpdatePtypoolApy}});var a=n(6194),u=n(4605),l=n(86026),o=n(83508),s=n(33737),r=n(93108),c=n(90947);let i=(0,r.Ue)(e=>({update:e}));function useUpdatePtypoolApy(e){let t=(0,c.p)(),n=a.iK[t]||[],r=(0,l.o)(e=>e.sliceLVaultsStore.lvaults,["sliceLVaultsStore.lvaults"]);(0,o.useEffect)(()=>{console.info("updatePtypoolApy"),null==n||n.forEach(n=>{let l=r[n.vault];if(n.ptyPoolAboveAddress&&l&&l.sellPoolTotalStaking&&i.getState().update({[n.ptyPoolAboveAddress]:{staking:(0,s.v)("0.025",10),matching:0n}}),n.ptyPoolBelowAddress&&l&&l.buyPoolTotalStaking&&!l.isStable){let o=l&&l.sellPoolTotalStaking*e[a.O1[t]],s=o>0n&&l.settingsDecimals>0n?l.M_ETHx*l.Y*e[n.xTokenAddress]*u.Pq/2n/o/l.settingsDecimals**10n:0n;i.getState().update({[n.ptyPoolBelowAddress]:{staking:s*10n**10n/u.Pq,matching:0n}})}})},[n,r,e,t])}},19532:function(e,t,n){"use strict";n.d(t,{D2:function(){return useWandContractRead},uX:function(){return useWandContractReads}}),n(66986);var a=n(83978),u=n.n(a);n(83508);var l=n(16931),o=n(61191),s=n(93108);let r=(0,s.Ue)(e=>({time:u().now(),update:()=>{e({time:u().now()})}}));function useWandContractRead(e){let{time:t}=r();return(0,l.u)({...e,query:{placeholderData:e=>e,refetchOnMount:!1,refetchOnWindowFocus:!1,...e.query||{}},wandtime:t})}function useWandContractReads(e){let{time:t}=r();return(0,o.N)({...e,query:{placeholderData:e=>e,refetchOnMount:!1,refetchOnWindowFocus:!1,...e.query||{}},wandtime:t})}},69275:function(e,t,n){"use strict";n.d(t,{g:function(){return V},A:function(){return FetcherProvider}});var a=n(52628),u=n(6194),l=n(4605),o=n(90947),s=n(83508),r=n(99120),c=n(87958),i=n(41340),p=n(6062),d=n(25495),f=n(11944),S=n(15493),v=n(181),h=n(88966);let V=(0,s.createContext)({prices:(0,S.Yb)({},0n),usbApr:{apr:0n,aprDecimals:10}}),FetcherProvider=e=>{let{children:t}=e;(0,v.d6)();let n=(0,o.p)();!function(){let{chainId:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,r.m)({chainId:e});s.useMemo(()=>(t&&(p.ON.provider=function(e){var t,n;let{chain:a,transport:u}=e,l={chainId:a.id,name:a.name,ensAddress:null===(n=a.contracts)||void 0===n?void 0:null===(t=n.ensRegistry)||void 0===t?void 0:t.address};return"fallback"===u.type?new c.H(u.transports.map(e=>{let{value:t}=e;return new i.r(null==t?void 0:t.url,l)})):new i.r(u.url,l)}(t)),p.ON.provider),[t])}();let B=(0,d.b)(()=>(0,S.Yb)({[u.O1[n]]:l.Pq},0n));(0,h.$$)(B);let m=(0,h.UM)();return(0,f.p)(B),(0,a.jsx)(V.Provider,{value:{prices:B,usbApr:m},children:t})}},181:function(e,t,n){"use strict";n.d(t,{R3:function(){return useUpBVaultForUserAction},Vw:function(){return useEpochesData},Zd:function(){return useBVaultEpoches},d6:function(){return useResetBVaultsData},gz:function(){return useCalcClaimable},lL:function(){return calcBVaultPTApy},nr:function(){return useBVault},oU:function(){return useBVaultApy},v7:function(){return useBVaultBoost}});var a=n(4605),u=n(90947),l=n(15493),o=n(2360),s=n(83978),r=n.n(s),c=n(83508),i=n(6951),p=n(86026);function useResetBVaultsData(){let e=(0,u.p)(),{address:t}=(0,i.m)();(0,c.useEffect)(()=>{},[e]),(0,c.useEffect)(()=>{p.w.getState().sliceUserBVaults.reset()},[t])}function useBVault(e){return(0,p.o)(t=>t.sliceBVaultsStore.bvaults[e]||(0,l.Yb)({current:(0,l.Yb)({},0n)},0n),["sliceBVaultsStore.bvaults.".concat(e)])}function useBVaultEpoches(e){return(0,p.o)(t=>{let n=t.sliceBVaultsStore.bvaults[e];if(!n||n.epochCount<=0n)return[];let a=r().range(1,parseInt((n.epochCount+1n).toString())).reverse(),u=t.sliceBVaultsStore.epoches;return a.map(t=>u["".concat(e,"_").concat(t)]).filter(e=>null!=e)},["sliceBVaultsStore.bvaults.".concat(e),"sliceBVaultsStore.epoches"])}function useEpochesData(e){let t=useBVaultEpoches(e),n=(0,p.o)(t=>t.sliceUserBVaults.epoches[e]||[],["sliceUserBVaults.epoches.".concat(e)]);return(0,c.useMemo)(()=>{let e=n.reduce((e,t)=>({...e,[t.epochId.toString()]:t}),{});return t.map(t=>(0,l.Yb)({...t,...e[t.epochId.toString()]||{bribes:[],sBribes:[],aBribes:[]}},0n))},[t,n])}function useCalcClaimable(e){let t=useEpochesData(e);return(0,c.useMemo)(()=>{let e=t.filter(e=>e.claimableAssetBalance&&e.settled);return{ids:e.map(e=>e.epochId),claimable:e.reduce((e,t)=>e+t.claimableAssetBalance,0n)}},[t])}function useBVaultBoost(e){let t=(0,p.o)(()=>(function(e){let t=p.w.getState(),n=t.sliceBVaultsStore.bvaults[e],u=(null==n?void 0:n.current.vaultYTokenBalance)||0n,l=(null==n?void 0:n.Y)||0n,s=l>0n?u*a.Pq/l:0n,r=(null==n?void 0:n.current.yTokenAmountForSwapYT)||0n,c=(null==n?void 0:n.lockedAssetTotal)||0n,i=r>0n?c*a.Pq/r:0n;return console.info("calcBootst:",(0,o.d)(s),(0,o.d)(i)),a.Pq,s})(e),["sliceBVaultsStore.bvaults.".concat(e)]);return[(0,o.d)(t,0),t]}function calcBVaultPTApy(e){let t=p.w.getState(),n=t.sliceBVaultsStore.bvaults[e.vault],u=(0,l.ok)(t.sliceBVaultsStore.yTokenSythetic,[e.vault]),o=0n;return o=e.pTokenV2?n&&n.ptRebaseRate&&n.pTokenTotal?n.ptRebaseRate/a.Pq*a.SH*BigInt(1e10)/n.pTokenTotal/a.Pq:0n:n&&n.current.assetTotalSwapAmount&&u?n.current.assetTotalSwapAmount*a.SH*BigInt(1e10)/u:0n,console.info("apy:",e.vault,o,e.pTokenV2,null==n?void 0:n.ptRebaseRate,null==n?void 0:n.pTokenTotal),o}function useBVaultApy(e){let t=(0,p.o)(()=>calcBVaultPTApy(e),["sliceBVaultsStore.bvaults.".concat(e.vault),"sliceBVaultsStore.yTokenSythetic.".concat(e.vault)]);return[(0,l.Jh)(t,10),t]}function useUpBVaultForUserAction(e,t){let{address:n}=(0,i.m)();return()=>{(0,l.XD)(async()=>{if(null==t||t(),!n)return;await Promise.all([p.w.getState().sliceTokenStore.updateTokensBalance([e.asset,e.pToken],n),p.w.getState().sliceTokenStore.updateTokenTotalSupply([e.asset,e.pToken]),p.w.getState().sliceBVaultsStore.updateBvaults([e]),p.w.getState().sliceBVaultsStore.updateYTokenSythetic([e])]);let a=p.w.getState().sliceBVaultsStore.bvaults[e.vault];await p.w.getState().sliceBVaultsStore.updateEpoches(e,a.epochCount>1n?[a.epochCount,a.epochCount-1n]:[a.epochCount]);let u=[];for(let t=parseInt(a.epochCount.toString());t>0;t--){let n=p.w.getState().sliceBVaultsStore.epoches["".concat(e.vault,"_").concat(t)];u.push(n)}console.info("onUserAction:epoches",u),await p.w.getState().sliceUserBVaults.updateEpoches(e,n,u)},3,1e3)}}},88966:function(e,t,n){"use strict";n.d(t,{$$:function(){return useSetLVaultPrices},UM:function(){return useUSBApr},aS:function(){return useValutsLeverageRatio},hC:function(){return useLVault},hY:function(){return useUserLVault},so:function(){return useUpLVaultOnUserAction},z6:function(){return useVaultLeverageRatio}});var a=n(6194),u=n(4605),l=n(90947),o=n(25495),s=n(15493),r=n(86026),c=n(6951),i=n(6062);let p=(0,s.Yb)({vaultMode:0,discountEnable:!1},0n),d=(0,s.Yb)({},0n);function useLVault(e){return(0,r.o)(t=>t.sliceLVaultsStore.lvaults[e]||p,["sliceLVaultsStore.lvaults.".concat(e)])}function useUserLVault(e){return(0,r.o)(t=>t.sliceLVaultsStore.user[e]||d,["sliceLVaultsStore.user.".concat(e)])}function useVaultLeverageRatio(e){let t=useLVault(e.vault),n=(0,s.pF)(t.aar,t.AARDecimals);return Math.max(0,1+1/(n-1))}function useValutsLeverageRatio(){let e=(0,l.p)(),t=a.iK[e]||[],n=(0,o.b)(()=>(0,s.Yb)({},0)),u=(0,r.o)(e=>e.sliceLVaultsStore.lvaults);return null==t||t.forEach(e=>{let t=u[e.vault],a=t?(0,s.pF)(t.aar,t.AARDecimals):0;n[e.vault]=Math.max(0,1+1/(a-1))}),n}function useSetLVaultPrices(e){var t;let n=(0,r.o)(e=>e.sliceLVaultsStore.lvaults),o=(0,r.o)(e=>e.sliceTokenStore.totalSupply),s=(0,l.p)();null===(t=a.iK[s])||void 0===t||t.forEach(t=>{let l=n[t.vault]||p,r=l.assetBalance,c=l.latestPrice,i=l.usbTotalSupply,d=o[t.xTokenAddress]||0n,f=d>0n&&r>0n&&c>0n&&i>0n&&r*c>i*u.Pq?(r*c-i*u.Pq)/d:0n;e[t.xTokenAddress]=f,e[t.assetTokenAddress]=c,d>0n&&r>0n&&c>0n&&i>0n&&r*c<i*u.Pq&&(e[a.O1[s]]=r*c/i)})}function useUSBApr(){var e;let t=(0,l.p)(),n=(0,r.o)(e=>e.sliceLVaultsStore.lvaults),u=0,o=0n,s=0n;return null===(e=a.iK[t])||void 0===e||e.forEach(e=>{let t=n[e.vault]||p;t.isStable?(o+=t.M_USB_USDC*t.Y*t.aar/10n**t.AARDecimals,s+=t.M_USB_USDC,t.M_USB_USDC>0n&&t.Y>0n&&u++):(o+=t.M_USB_ETH*t.Y,s+=t.M_USB_ETH,t.M_USB_ETH>0n&&t.Y>0n&&u++)}),{apr:s>0n?o/s:0n,aprDecimals:10}}function useUpLVaultOnUserAction(e){let{address:t}=(0,c.m)();return()=>{(0,s.XD)(async()=>{if(!t)return;let n=r.w.getState().sliceLVaultsStore,u=[e.assetTokenAddress,e.xTokenAddress,a.O1[(0,i.BV)()]];await Promise.all([n.updateLVaults([e]),n.updateUserLVault(e,t),r.w.getState().sliceTokenStore.updateTokensBalance(u,t),r.w.getState().sliceTokenStore.updateTokenTotalSupply(u)])},3,1e3).catch(console.error)}}}}]);