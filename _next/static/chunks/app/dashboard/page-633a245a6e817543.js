(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7702],{79391:function(){},5338:function(e,t,s){Promise.resolve().then(s.bind(s,11539))},11539:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return Dashboard}});var n=s(52987),l=s(31506),a=s(26694),o=s(27022),r=s(58400),u=s(81501),i=s(79999),c=s(96555),d=s(99409),m=s(422),p=s(77317),v=s(19504);s(83810),s(43213);var f=s(13854),h=s(32422),x=s(83978),b=s.n(x),S=s(7347),y=s(29293),g=s(55731),k=s(52100),T=s(13012),A=s(40460);let V=(0,T.fn)("TableCell"),j=p.forwardRef((e,t)=>{let{children:s,className:n}=e,l=(0,g._T)(e,["children","className"]);return p.createElement(p.Fragment,null,p.createElement("td",Object.assign({ref:t,className:(0,A.q)(V("root"),"align-middle whitespace-nowrap tabular-nums text-left",k.W.twoXl.paddingAll,n)},l),s))});j.displayName="TableCell";var w=s(787),P=s(40292);let L=(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",children:(0,n.jsx)("circle",{cx:"7",cy:"7",r:"5",fill:"white",stroke:"#00DE9C",strokeWidth:"4"})});function DashItem(e){let{title:t,sub:s,tHeader:l,tData:a}=e;return(0,n.jsxs)("div",{className:"card whitespace-nowrap",children:["string"==typeof t?(0,n.jsx)("div",{className:"text-2xl leading-none font-semibold",children:t}):t,"string"==typeof s?(0,n.jsx)("div",{className:"text-[2rem] text-primary leading-none font-semibold mt-2",children:s}):s,(0,n.jsx)("div",{className:"my-4 h-[1px] bg-border/60 dark:bg-border"}),(0,n.jsx)("div",{className:"w-full overflow-x-auto",children:(0,n.jsx)(o.ZP,{headerClassName:"border-b-0",header:l,data:a})})]})}function TVLItem(){let e=function(){let e=(0,d.p)(),t=i.iK[e]||[],s=r.Fw[e].filter(e=>(e.onEnv||[]).includes(c.Vi)),{prices:n}=(0,p.useContext)(v.g),l=(0,h.o)(e=>e.sliceLVaultsStore.lvaults),a=(0,h.o)(e=>e.sliceTokenStore.totalSupply),o=t.map(e=>{var t;return(null===(t=l[e.vault])||void 0===t?void 0:t.usbTotalSupply)||0n}).reduce((e,t)=>e+t,0n),m=(0,h.o)(e=>e.sliceBVaultsStore.bvaults),f=(0,h.o)(e=>e.sliceTokenStore.prices),x=t.map(e=>({name:e.xTokenSymbol+e.version,symbol:e.xTokenSymbol,address:e.xTokenAddress})).map(e=>{let t=n[e.address],s=e.symbol==i.TW?o:a[e.address]||0n,l=t*s/c.Pq;return{...e,decimals:18,price:t,amount:s,usdAmount:l}}).concat(t.filter(e=>!e.isStable).map(t=>{let s=l[t.vault],a=((null==s?void 0:s.sellPoolTotalStaking)||0n)+((null==s?void 0:s.buyPoolBalance)||0n),o=n[t.assetTokenAddress],r=(0,S.kb)(t.assetTokenAddress,e).decimals,u=o*a/10n**BigInt(r);return{name:t.assetTokenSymbol+t.version,symbol:t.assetTokenSymbol,decimals:r,address:t.assetTokenAddress,price:o,amount:a,usdAmount:u}})).concat(b().chain(s).mapValues(t=>{let s=u.P[t.asset],n=m[t.vault],l=s&&n&&n.lpLiq&&n.lpBase&&n.lpQuote&&f[s.base]&&f[s.quote],a=l?(f[s.base]*n.lpBase+f[s.quote]*n.lpQuote)/n.lpLiq:f[t.asset]||c.Pq,o=(null==n?void 0:n.lpLiq)||(null==n?void 0:n.lockedAssetTotal)||0n,r=(0,S.kb)(t.asset,e).decimals;return{name:t.assetSymbol,symbol:t.assetSymbol,address:t.asset,decimals:r,price:a,amount:o,usdAmount:a*o/10n**BigInt(r)}}).values().reduce((e,t)=>{let s=e.find(e=>e.symbol==t.symbol);return s?(s.amount+=t.amount,s.usdAmount+=t.usdAmount,e):[...e,t]},[]).value()),y=x.reduce((e,t)=>e+t.usdAmount,0n);return{tvl:y,tvlItems:x}}(),t=(0,p.useMemo)(()=>e.tvlItems.map(e=>[(0,n.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,n.jsx)(l.c,{symbol:e.symbol,size:20}),(0,n.jsx)("span",{children:e.symbol})]},"icon"),"$".concat((0,y.d)(e.price)),(0,y.d)(e.amount,void 0,e.decimals),"$".concat((0,y.d)(e.usdAmount))]),[e.tvlItems]);return(0,n.jsx)(DashItem,{title:"Total Value Locked",sub:"$".concat((0,y.d)(e.tvl)),tHeader:["Asset","NAV","Amount","Total"],tData:t})}function BVaultROI(e){let{vc:t}=e,{roi:s}=(0,P.tY)(t);return(0,n.jsx)(n.Fragment,{children:(0,f.Jh)(s,18,2)})}function BVaultsItem(){let e=(0,d.p)(),t=(0,p.useMemo)(()=>r.Fw[e].filter(e=>(e.onEnv||[]).includes(c.Vi)),[e]),s=(0,h.o)(e=>e.sliceBVaultsStore.bvaults,["sliceBVaultsStore.bvaults"]),a=(0,h.o)(e=>e.sliceTokenStore.prices,["sliceTokenStore.prices"]),o=(0,p.useMemo)(()=>{let o=t.map(t=>{let n=(0,S.kb)(t.asset,e).decimals,l=(0,f.ok)(s,[t.vault,"lockedAssetTotal"]),o=l*(0,f.ok)(a,[t.asset])/10n**BigInt(n),r=u.P[t.asset];if(r){let e=(0,f.ok)(s,[t.vault,"lpBase"]),n=(0,f.ok)(s,[t.vault,"lpQuote"]);o=(e*(0,f.ok)(a,[r.base])+n*(0,f.ok)(a,[r.quote]))/c.Pq}let[i,d]=r?t.assetSymbol.split("-"):["",""],m=Math.max(22+5*(0,y.d)(l).length,5*(0,y.d)(o).length+5);return{bvc:t,totalDeposit:l,decimals:n,totalDepositUsd:o,totalLeftWidth:m,lp:r,baseSymbol:i,quoteSymbol:d}}),r=o.reduce((e,t)=>Math.max(e,t.totalLeftWidth),0)+20;return o.map(e=>{let{bvc:t,totalDeposit:a,decimals:o,totalDepositUsd:u,lp:i,baseSymbol:c,quoteSymbol:d}=e;return[(0,n.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,n.jsx)(l.c,{symbol:t.assetSymbol,size:20}),(0,n.jsx)("span",{children:t.assetSymbol})]},"icon"),(0,n.jsxs)("div",{className:"flex gap-8 items-start",children:[(0,n.jsxs)("div",{style:{width:r},children:[(0,n.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,n.jsx)(l.c,{symbol:t.assetSymbol,size:14}),(0,n.jsx)("span",{children:(0,y.d)(a,void 0,o)})]},"icon"),(0,n.jsxs)("div",{className:"opacity-60",children:["~",(0,y.d)(u)]})]}),i&&(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,n.jsx)(l.c,{symbol:c,size:14}),(0,n.jsx)("span",{children:(0,y.d)((0,f.ok)(s,[t.vault,"lpBase"]))})]},"icon"),(0,n.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,n.jsx)(l.c,{symbol:d,size:14}),(0,n.jsx)("span",{children:(0,y.d)((0,f.ok)(s,[t.vault,"lpQuote"]))})]},"icon")]})]},"total"),(0,n.jsxs)("div",{className:"flex gap-2 items-center",children:[L,(0,n.jsxs)("span",{children:["Epoch ",(0,f.ok)(s,[t.vault,"epochCount"]).toString()]})]},"status"),(0,n.jsx)(w.sp,{bvc:t},"apy"),(0,n.jsx)(BVaultROI,{vc:t},"roi")]})},[t,s,a]);return(0,n.jsx)(DashItem,{title:"B-Vault",tHeader:["Vaults","Total Deposit","Status","PT APY","YT ROI"],tData:o})}function Dashboard(){return(0,m.a1)(),(0,m.Ev)(),(0,d.p)(),(0,n.jsx)(a.E,{children:(0,n.jsxs)("div",{className:"w-full max-w-[1200px] px-4 mx-auto flex flex-col gap-5 md:pb-8",children:[(0,n.jsx)(TVLItem,{}),(0,n.jsx)(BVaultsItem,{})]})})}},16549:function(e,t,s){"use strict";s.d(t,{b:function(){return useMemoOfChainId}});var n=s(77317),l=s(99409);function useMemoOfChainId(e){let t=(0,l.p)(),s=(0,n.useRef)({});return(0,n.useMemo)(()=>(s.current[t]||(s.current[t]=e()),s.current[t]),[t])}},86008:function(e,t,s){"use strict";s.d(t,{i:function(){return c},p:function(){return useUpdatePtypoolApy}});var n=s(79999),l=s(96555),a=s(32422),o=s(77317),r=s(13277),u=s(93108),i=s(99409);let c=(0,u.Ue)(e=>({update:e}));function useUpdatePtypoolApy(e){let t=(0,i.p)(),s=n.iK[t]||[],u=(0,a.o)(e=>e.sliceLVaultsStore.lvaults,["sliceLVaultsStore.lvaults"]);(0,o.useEffect)(()=>{console.info("updatePtypoolApy"),null==s||s.forEach(s=>{let a=u[s.vault];if(s.ptyPoolAboveAddress&&a&&a.sellPoolTotalStaking&&c.getState().update({[s.ptyPoolAboveAddress]:{staking:(0,r.v)("0.025",10),matching:0n}}),s.ptyPoolBelowAddress&&a&&a.buyPoolTotalStaking&&!a.isStable){let o=a&&a.sellPoolTotalStaking*e[n.O1[t]],r=o>0n&&a.settingsDecimals>0n?a.M_ETHx*a.Y*e[s.xTokenAddress]*l.Pq/2n/o/a.settingsDecimals**10n:0n;c.getState().update({[s.ptyPoolBelowAddress]:{staking:r*10n**10n/l.Pq,matching:0n}})}})},[s,u,e,t])}},83810:function(e,t,s){"use strict";s.d(t,{D2:function(){return useWandContractRead},uX:function(){return useWandContractReads}}),s(62628);var n=s(83978),l=s.n(n);s(77317);var a=s(7886),o=s(17032),r=s(93108);let u=(0,r.Ue)(e=>({time:l().now(),update:()=>{e({time:l().now()})}}));function useWandContractRead(e){let{time:t}=u();return(0,a.u)({...e,query:{placeholderData:e=>e,refetchOnMount:!1,refetchOnWindowFocus:!1,...e.query||{}},wandtime:t})}function useWandContractReads(e){let{time:t}=u();return(0,o.N)({...e,query:{placeholderData:e=>e,refetchOnMount:!1,refetchOnWindowFocus:!1,...e.query||{}},wandtime:t})}},19504:function(e,t,s){"use strict";s.d(t,{g:function(){return x},A:function(){return FetcherProvider}});var n=s(52987),l=s(79999),a=s(96555),o=s(99409),r=s(77317),u=s(84032),i=s(87958),c=s(41340),d=s(53414),m=s(16549),p=s(86008),v=s(13854),f=s(44100),h=s(79229);let x=(0,r.createContext)({prices:(0,v.Yb)({},0n),usbApr:{apr:0n,aprDecimals:10}}),FetcherProvider=e=>{let{children:t}=e;(0,f.d6)();let s=(0,o.p)();!function(){let{chainId:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,u.m)({chainId:e});r.useMemo(()=>(t&&(d.ON.provider=function(e){var t,s;let{chain:n,transport:l}=e,a={chainId:n.id,name:n.name,ensAddress:null===(s=n.contracts)||void 0===s?void 0:null===(t=s.ensRegistry)||void 0===t?void 0:t.address};return"fallback"===l.type?new i.H(l.transports.map(e=>{let{value:t}=e;return new c.r(null==t?void 0:t.url,a)})):new c.r(l.url,a)}(t)),d.ON.provider),[t])}();let b=(0,m.b)(()=>(0,v.Yb)({[l.O1[s]]:a.Pq},0n));(0,h.$$)(b);let S=(0,h.UM)();return(0,p.p)(b),(0,n.jsx)(x.Provider,{value:{prices:b,usbApr:S},children:t})}},79229:function(e,t,s){"use strict";s.d(t,{$$:function(){return useSetLVaultPrices},UM:function(){return useUSBApr},aS:function(){return useValutsLeverageRatio},hC:function(){return useLVault},hY:function(){return useUserLVault},so:function(){return useUpLVaultOnUserAction},z6:function(){return useVaultLeverageRatio}});var n=s(79999),l=s(96555),a=s(99409),o=s(16549),r=s(13854),u=s(32422),i=s(87621),c=s(53414);let d=(0,r.Yb)({vaultMode:0,discountEnable:!1},0n),m=(0,r.Yb)({},0n);function useLVault(e){return(0,u.o)(t=>t.sliceLVaultsStore.lvaults[e]||d,["sliceLVaultsStore.lvaults.".concat(e)])}function useUserLVault(e){return(0,u.o)(t=>t.sliceLVaultsStore.user[e]||m,["sliceLVaultsStore.user.".concat(e)])}function useVaultLeverageRatio(e){let t=useLVault(e.vault),s=(0,r.pF)(t.aar,t.AARDecimals);return Math.max(0,1+1/(s-1))}function useValutsLeverageRatio(){let e=(0,a.p)(),t=n.iK[e]||[],s=(0,o.b)(()=>(0,r.Yb)({},0)),l=(0,u.o)(e=>e.sliceLVaultsStore.lvaults);return null==t||t.forEach(e=>{let t=l[e.vault],n=t?(0,r.pF)(t.aar,t.AARDecimals):0;s[e.vault]=Math.max(0,1+1/(n-1))}),s}function useSetLVaultPrices(e){var t;let s=(0,u.o)(e=>e.sliceLVaultsStore.lvaults),o=(0,u.o)(e=>e.sliceTokenStore.totalSupply),r=(0,a.p)();null===(t=n.iK[r])||void 0===t||t.forEach(t=>{let a=s[t.vault]||d,u=a.assetBalance,i=a.latestPrice,c=a.usbTotalSupply,m=o[t.xTokenAddress]||0n,p=m>0n&&u>0n&&i>0n&&c>0n&&u*i>c*l.Pq?(u*i-c*l.Pq)/m:0n;e[t.xTokenAddress]=p,e[t.assetTokenAddress]=i,m>0n&&u>0n&&i>0n&&c>0n&&u*i<c*l.Pq&&(e[n.O1[r]]=u*i/c)})}function useUSBApr(){var e;let t=(0,a.p)(),s=(0,u.o)(e=>e.sliceLVaultsStore.lvaults),l=0,o=0n,r=0n;return null===(e=n.iK[t])||void 0===e||e.forEach(e=>{let t=s[e.vault]||d;t.isStable?(o+=t.M_USB_USDC*t.Y*t.aar/10n**t.AARDecimals,r+=t.M_USB_USDC,t.M_USB_USDC>0n&&t.Y>0n&&l++):(o+=t.M_USB_ETH*t.Y,r+=t.M_USB_ETH,t.M_USB_ETH>0n&&t.Y>0n&&l++)}),{apr:r>0n?o/r:0n,aprDecimals:10}}function useUpLVaultOnUserAction(e){let{address:t}=(0,i.m)();return()=>{(0,r.XD)(async()=>{if(!t)return;let s=u.w.getState().sliceLVaultsStore,l=[e.assetTokenAddress,e.xTokenAddress,n.O1[(0,c.BV)()]];await Promise.all([s.updateLVaults([e]),s.updateUserLVault(e,t),u.w.getState().sliceTokenStore.updateTokensBalance(l,t),u.w.getState().sliceTokenStore.updateTokenTotalSupply(l)])},3,1e3).catch(console.error)}}}},function(e){e.O(0,[4881,7495,7622,5294,3113,4105,3296,5736,2444,8178,9802,6466,4619,7509,5049,4882,320,1838,3668,2422,5793,9109,2847,4195,6338,1744],function(){return e(e.s=5338)}),_N_E=e.O()}]);