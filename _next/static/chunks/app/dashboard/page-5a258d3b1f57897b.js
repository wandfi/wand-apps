(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7702],{79391:function(){},36599:function(e,t,s){Promise.resolve().then(s.bind(s,94401))},94401:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return Dashboard}});var l=s(31113),n=s(99971),a=s(44939),o=s(75496),r=s(87031),u=s(44020),i=s(19757),c=s(22139),d=s(59175),m=s(31889),p=s(64103),v=s(52671);s(15506),s(79099);var f=s(63126),h=s(8298),x=s(83978),b=s.n(x),S=s(84944),y=s(55731),g=s(52100),k=s(13012),T=s(40460);let A=(0,k.fn)("TableCell"),V=p.forwardRef((e,t)=>{let{children:s,className:l}=e,n=(0,y.__rest)(e,["children","className"]);return p.createElement(p.Fragment,null,p.createElement("td",Object.assign({ref:t,className:(0,T.q)(A("root"),"align-middle whitespace-nowrap tabular-nums text-left",g.W.twoXl.paddingAll,l)},n),s))});V.displayName="TableCell";var j=s(85593),w=s(10494);let P=(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",children:(0,l.jsx)("circle",{cx:"7",cy:"7",r:"5",fill:"white",stroke:"#00DE9C",strokeWidth:"4"})});function DashItem(e){let{title:t,sub:s,tHeader:n,tData:a}=e;return(0,l.jsxs)("div",{className:"card whitespace-nowrap",children:["string"==typeof t?(0,l.jsx)("div",{className:"text-2xl leading-none font-semibold",children:t}):t,"string"==typeof s?(0,l.jsx)("div",{className:"text-[2rem] text-primary leading-none font-semibold mt-2",children:s}):s,(0,l.jsx)("div",{className:"my-4 h-[1px] bg-border/60 dark:bg-border"}),(0,l.jsx)("div",{className:"w-full overflow-x-auto",children:(0,l.jsx)(o.ZP,{headerClassName:"border-b-0",header:n,data:a})})]})}function TVLItem(){let e=function(){let e=(0,d.p)(),t=i.iK[e]||[],s=r.Fw[e].filter(e=>(e.onEnv||[]).includes(c.Vi)),{prices:l}=(0,p.useContext)(v.g),n=(0,h.o)(e=>e.sliceLVaultsStore.lvaults),a=(0,h.o)(e=>e.sliceTokenStore.totalSupply),o=t.map(e=>{var t;return(null===(t=n[e.vault])||void 0===t?void 0:t.usbTotalSupply)||0n}).reduce((e,t)=>e+t,0n),m=(0,h.o)(e=>e.sliceBVaultsStore.bvaults),f=(0,h.o)(e=>e.sliceTokenStore.prices),x=t.map(e=>({name:e.xTokenSymbol+e.version,symbol:e.xTokenSymbol,address:e.xTokenAddress})).map(e=>{let t=l[e.address],s=e.symbol==i.TW?o:a[e.address]||0n,n=t*s/c.Pq;return{...e,price:t,amount:s,usdAmount:n}}).concat(t.filter(e=>!e.isStable).map(e=>{let t=n[e.vault],s=((null==t?void 0:t.sellPoolTotalStaking)||0n)+((null==t?void 0:t.buyPoolBalance)||0n),a=l[e.assetTokenAddress],o=a*s/c.Pq;return{name:e.assetTokenSymbol+e.version,symbol:e.assetTokenSymbol,address:e.assetTokenAddress,price:a,amount:s,usdAmount:o}})).concat(b().chain(s).mapValues(e=>{let t=u.P[e.asset],s=m[e.vault],l=t&&s&&s.lpLiq&&s.lpBase&&s.lpQuote&&f[t.base]&&f[t.quote],n=l?(f[t.base]*s.lpBase+f[t.quote]*s.lpQuote)/s.lpLiq:f[e.asset]||c.Pq,a=(null==s?void 0:s.lpLiq)||(null==s?void 0:s.lockedAssetTotal)||0n;return{name:e.assetSymbol,symbol:e.assetSymbol,address:e.asset,price:n,amount:a,usdAmount:n*a/c.Pq}}).values().reduce((e,t)=>{let s=e.find(e=>e.symbol==t.symbol);return s?(s.amount+=t.amount,s.usdAmount+=t.usdAmount,e):[...e,t]},[]).value()),S=x.reduce((e,t)=>e+t.usdAmount,0n);return{tvl:S,tvlItems:x}}(),t=(0,p.useMemo)(()=>e.tvlItems.map(e=>[(0,l.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,l.jsx)(n.c,{symbol:e.symbol,size:20}),(0,l.jsx)("span",{children:e.symbol})]},"icon"),"$".concat((0,S.d)(e.price)),(0,S.d)(e.amount),"$".concat((0,S.d)(e.usdAmount))]),[e.tvlItems]);return(0,l.jsx)(DashItem,{title:"Total Value Locked",sub:"$".concat((0,S.d)(e.tvl)),tHeader:["Asset","NAV","Amount","Total"],tData:t})}function BVaultROI(e){let{vc:t}=e,{roi:s}=(0,w.tY)(t);return(0,l.jsx)(l.Fragment,{children:(0,f.Jh)(s,18,2)})}function BVaultsItem(){let e=(0,d.p)(),t=(0,p.useMemo)(()=>r.Fw[e].filter(e=>(e.onEnv||[]).includes(c.Vi)),[e]),s=(0,h.o)(e=>e.sliceBVaultsStore.bvaults,["sliceBVaultsStore.bvaults"]),a=(0,h.o)(e=>e.sliceTokenStore.prices,["sliceTokenStore.prices"]),o=(0,p.useMemo)(()=>{let e=t.map(e=>{let t=(0,f.ok)(s,[e.vault,"lockedAssetTotal"]),l=t*(0,f.ok)(a,[e.asset])/c.Pq,n=u.P[e.asset];if(n){let t=(0,f.ok)(s,[e.vault,"lpBase"]),o=(0,f.ok)(s,[e.vault,"lpQuote"]);l=(t*(0,f.ok)(a,[n.base])+o*(0,f.ok)(a,[n.quote]))/c.Pq}let[o,r]=n?e.assetSymbol.split("-"):["",""],i=Math.max(22+5*(0,S.d)(t).length,5*(0,S.d)(l).length+5);return{bvc:e,totalDeposit:t,totalDepositUsd:l,totalLeftWidth:i,lp:n,baseSymbol:o,quoteSymbol:r}}),o=e.reduce((e,t)=>Math.max(e,t.totalLeftWidth),0)+20;return e.map(e=>{let{bvc:t,totalDeposit:a,totalDepositUsd:r,lp:u,baseSymbol:i,quoteSymbol:c}=e;return[(0,l.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,l.jsx)(n.c,{symbol:t.assetSymbol,size:20}),(0,l.jsx)("span",{children:t.assetSymbol})]},"icon"),(0,l.jsxs)("div",{className:"flex gap-8 items-start",children:[(0,l.jsxs)("div",{style:{width:o},children:[(0,l.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,l.jsx)(n.c,{symbol:t.assetSymbol,size:14}),(0,l.jsx)("span",{children:(0,S.d)(a)})]},"icon"),(0,l.jsxs)("div",{className:"opacity-60",children:["~",(0,S.d)(r)]})]}),u&&(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,l.jsx)(n.c,{symbol:i,size:14}),(0,l.jsx)("span",{children:(0,S.d)((0,f.ok)(s,[t.vault,"lpBase"]))})]},"icon"),(0,l.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,l.jsx)(n.c,{symbol:c,size:14}),(0,l.jsx)("span",{children:(0,S.d)((0,f.ok)(s,[t.vault,"lpQuote"]))})]},"icon")]})]},"total"),(0,l.jsxs)("div",{className:"flex gap-2 items-center",children:[P,(0,l.jsxs)("span",{children:["Epoch ",(0,f.ok)(s,[t.vault,"epochCount"]).toString()]})]},"status"),(0,l.jsx)(j.sp,{bvc:t},"apy"),(0,l.jsx)(BVaultROI,{vc:t},"roi")]})},[t,s,a]);return(0,l.jsx)(DashItem,{title:"B-Vault",tHeader:["Vaults","Total Deposit","Status","PT APY","YT ROI"],tData:o})}function Dashboard(){return(0,m.a1)(),(0,m.Ev)(),(0,d.p)(),(0,l.jsx)(a.E,{children:(0,l.jsxs)("div",{className:"w-full max-w-[1200px] px-4 mx-auto flex flex-col gap-5 md:pb-8",children:[(0,l.jsx)(TVLItem,{}),(0,l.jsx)(BVaultsItem,{})]})})}},88439:function(e,t,s){"use strict";s.d(t,{b:function(){return useMemoOfChainId}});var l=s(64103),n=s(59175);function useMemoOfChainId(e){let t=(0,n.p)(),s=(0,l.useRef)({});return(0,l.useMemo)(()=>(s.current[t]||(s.current[t]=e()),s.current[t]),[t])}},45438:function(e,t,s){"use strict";s.d(t,{i:function(){return c},p:function(){return useUpdatePtypoolApy}});var l=s(19757),n=s(22139),a=s(8298),o=s(64103),r=s(33737),u=s(93108),i=s(59175);let c=(0,u.Ue)(e=>({update:e}));function useUpdatePtypoolApy(e){let t=(0,i.p)(),s=l.iK[t]||[],u=(0,a.o)(e=>e.sliceLVaultsStore.lvaults,["sliceLVaultsStore.lvaults"]);(0,o.useEffect)(()=>{console.info("updatePtypoolApy"),null==s||s.forEach(s=>{let a=u[s.vault];if(s.ptyPoolAboveAddress&&a&&a.sellPoolTotalStaking&&c.getState().update({[s.ptyPoolAboveAddress]:{staking:(0,r.v)("0.025",10),matching:0n}}),s.ptyPoolBelowAddress&&a&&a.buyPoolTotalStaking&&!a.isStable){let o=a&&a.sellPoolTotalStaking*e[l.O1[t]],r=o>0n&&a.settingsDecimals>0n?a.M_ETHx*a.Y*e[s.xTokenAddress]*n.Pq/2n/o/a.settingsDecimals**10n:0n;c.getState().update({[s.ptyPoolBelowAddress]:{staking:r*10n**10n/n.Pq,matching:0n}})}})},[s,u,e,t])}},15506:function(e,t,s){"use strict";s.d(t,{D2:function(){return useWandContractRead},uX:function(){return useWandContractReads}}),s(78403);var l=s(83978),n=s.n(l);s(64103);var a=s(30308),o=s(59307),r=s(93108);let u=(0,r.Ue)(e=>({time:n().now(),update:()=>{e({time:n().now()})}}));function useWandContractRead(e){let{time:t}=u();return(0,a.u)({...e,query:{placeholderData:e=>e,refetchOnMount:!1,refetchOnWindowFocus:!1,...e.query||{}},wandtime:t})}function useWandContractReads(e){let{time:t}=u();return(0,o.N)({...e,query:{placeholderData:e=>e,refetchOnMount:!1,refetchOnWindowFocus:!1,...e.query||{}},wandtime:t})}},52671:function(e,t,s){"use strict";s.d(t,{g:function(){return x},A:function(){return FetcherProvider}});var l=s(31113),n=s(19757),a=s(22139),o=s(59175),r=s(64103),u=s(25233),i=s(87958),c=s(41340),d=s(73216),m=s(88439),p=s(45438),v=s(63126),f=s(18358),h=s(39577);let x=(0,r.createContext)({prices:(0,v.Yb)({},0n),usbApr:{apr:0n,aprDecimals:10}}),FetcherProvider=e=>{let{children:t}=e;(0,f.d6)();let s=(0,o.p)();!function(){let{chainId:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,u.m)({chainId:e});r.useMemo(()=>(t&&(d.ON.provider=function(e){var t,s;let{chain:l,transport:n}=e,a={chainId:l.id,name:l.name,ensAddress:null===(s=l.contracts)||void 0===s?void 0:null===(t=s.ensRegistry)||void 0===t?void 0:t.address};return"fallback"===n.type?new i.H(n.transports.map(e=>{let{value:t}=e;return new c.r(null==t?void 0:t.url,a)})):new c.r(n.url,a)}(t)),d.ON.provider),[t])}();let b=(0,m.b)(()=>(0,v.Yb)({[n.O1[s]]:a.Pq},0n));(0,h.$$)(b);let S=(0,h.UM)();return(0,p.p)(b),(0,l.jsx)(x.Provider,{value:{prices:b,usbApr:S},children:t})}},39577:function(e,t,s){"use strict";s.d(t,{$$:function(){return useSetLVaultPrices},UM:function(){return useUSBApr},aS:function(){return useValutsLeverageRatio},hC:function(){return useLVault},hY:function(){return useUserLVault},so:function(){return useUpLVaultOnUserAction},z6:function(){return useVaultLeverageRatio}});var l=s(19757),n=s(22139),a=s(59175),o=s(88439),r=s(63126),u=s(8298),i=s(96670),c=s(73216);let d=(0,r.Yb)({vaultMode:0,discountEnable:!1},0n),m=(0,r.Yb)({},0n);function useLVault(e){return(0,u.o)(t=>t.sliceLVaultsStore.lvaults[e]||d,["sliceLVaultsStore.lvaults.".concat(e)])}function useUserLVault(e){return(0,u.o)(t=>t.sliceLVaultsStore.user[e]||m,["sliceLVaultsStore.user.".concat(e)])}function useVaultLeverageRatio(e){let t=useLVault(e.vault),s=(0,r.pF)(t.aar,t.AARDecimals);return Math.max(0,1+1/(s-1))}function useValutsLeverageRatio(){let e=(0,a.p)(),t=l.iK[e]||[],s=(0,o.b)(()=>(0,r.Yb)({},0)),n=(0,u.o)(e=>e.sliceLVaultsStore.lvaults);return null==t||t.forEach(e=>{let t=n[e.vault],l=t?(0,r.pF)(t.aar,t.AARDecimals):0;s[e.vault]=Math.max(0,1+1/(l-1))}),s}function useSetLVaultPrices(e){var t;let s=(0,u.o)(e=>e.sliceLVaultsStore.lvaults),o=(0,u.o)(e=>e.sliceTokenStore.totalSupply),r=(0,a.p)();null===(t=l.iK[r])||void 0===t||t.forEach(t=>{let a=s[t.vault]||d,u=a.assetBalance,i=a.latestPrice,c=a.usbTotalSupply,m=o[t.xTokenAddress]||0n,p=m>0n&&u>0n&&i>0n&&c>0n&&u*i>c*n.Pq?(u*i-c*n.Pq)/m:0n;e[t.xTokenAddress]=p,e[t.assetTokenAddress]=i,m>0n&&u>0n&&i>0n&&c>0n&&u*i<c*n.Pq&&(e[l.O1[r]]=u*i/c)})}function useUSBApr(){var e;let t=(0,a.p)(),s=(0,u.o)(e=>e.sliceLVaultsStore.lvaults),n=0,o=0n,r=0n;return null===(e=l.iK[t])||void 0===e||e.forEach(e=>{let t=s[e.vault]||d;t.isStable?(o+=t.M_USB_USDC*t.Y*t.aar/10n**t.AARDecimals,r+=t.M_USB_USDC,t.M_USB_USDC>0n&&t.Y>0n&&n++):(o+=t.M_USB_ETH*t.Y,r+=t.M_USB_ETH,t.M_USB_ETH>0n&&t.Y>0n&&n++)}),{apr:r>0n?o/r:0n,aprDecimals:10}}function useUpLVaultOnUserAction(e){let{address:t}=(0,i.m)();return()=>{(0,r.XD)(async()=>{if(!t)return;let s=u.w.getState().sliceLVaultsStore,n=[e.assetTokenAddress,e.xTokenAddress,l.O1[(0,c.BV)()]];await Promise.all([s.updateLVaults([e]),s.updateUserLVault(e,t),u.w.getState().sliceTokenStore.updateTokensBalance(n,t),u.w.getState().sliceTokenStore.updateTokenTotalSupply(n)])},3,1e3).catch(console.error)}}}},function(e){e.O(0,[4881,5294,7495,7622,3113,4105,2882,4300,9637,6466,2653,6087,2487,8959,2814,1749,8298,3047,4090,5593,7093,604,1744],function(){return e(e.s=36599)}),_N_E=e.O()}]);