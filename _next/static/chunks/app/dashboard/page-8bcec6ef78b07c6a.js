(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7702],{79391:function(){},36599:function(e,t,s){Promise.resolve().then(s.bind(s,94401))},94401:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return Dashboard}});var n=s(31113),l=s(99971),a=s(44939),o=s(75496),r=s(87031),u=s(44020),i=s(19757),c=s(22139),d=s(59175),m=s(31889),p=s(64103),v=s(52671);s(15506),s(38894);var f=s(26361),h=s(55349),x=s(83978),b=s.n(x),S=s(18358),y=s(84944),k=s(55731),g=s(52100),T=s(13012),A=s(40460);let V=(0,T.fn)("TableCell"),w=p.forwardRef((e,t)=>{let{children:s,className:n}=e,l=(0,k.__rest)(e,["children","className"]);return p.createElement(p.Fragment,null,p.createElement("td",Object.assign({ref:t,className:(0,A.q)(V("root"),"align-middle whitespace-nowrap tabular-nums text-left",g.W.twoXl.paddingAll,n)},l),s))});w.displayName="TableCell";var j=s(13137);let P=(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",children:(0,n.jsx)("circle",{cx:"7",cy:"7",r:"5",fill:"white",stroke:"#00DE9C",strokeWidth:"4"})});function DashItem(e){let{title:t,sub:s,tHeader:l,tData:a}=e;return(0,n.jsxs)("div",{className:"card whitespace-nowrap",children:["string"==typeof t?(0,n.jsx)("div",{className:"text-2xl leading-none font-semibold",children:t}):t,"string"==typeof s?(0,n.jsx)("div",{className:"text-[2rem] text-primary leading-none font-semibold mt-2",children:s}):s,(0,n.jsx)("div",{className:"my-4 h-[1px] bg-border/60 dark:bg-border"}),(0,n.jsx)("div",{className:"w-full overflow-x-auto",children:(0,n.jsx)(o.ZP,{headerClassName:"border-b-0",header:l,data:a})})]})}function TVLItem(){let e=function(){let e=(0,d.p)(),t=i.iK[e]||[],s=r.Fw[e].filter(e=>(e.onEnv||[]).includes(c.Vi)),{prices:n}=(0,p.useContext)(v.g),l=(0,h.o)(e=>e.sliceLVaultsStore.lvaults),a=(0,h.o)(e=>e.sliceTokenStore.totalSupply),o=t.map(e=>{var t;return(null===(t=l[e.vault])||void 0===t?void 0:t.usbTotalSupply)||0n}).reduce((e,t)=>e+t,0n),m=(0,h.o)(e=>e.sliceBVaultsStore.bvaults),f=(0,h.o)(e=>e.sliceTokenStore.prices),x=t.map(e=>({name:e.xTokenSymbol+e.version,symbol:e.xTokenSymbol,address:e.xTokenAddress})).map(e=>{let t=n[e.address],s=e.symbol==i.TW?o:a[e.address]||0n,l=t*s/c.Pq;return{...e,price:t,amount:s,usdAmount:l}}).concat(t.filter(e=>!e.isStable).map(e=>{let t=l[e.vault],s=((null==t?void 0:t.sellPoolTotalStaking)||0n)+((null==t?void 0:t.buyPoolBalance)||0n),a=n[e.assetTokenAddress],o=a*s/c.Pq;return{name:e.assetTokenSymbol+e.version,symbol:e.assetTokenSymbol,address:e.assetTokenAddress,price:a,amount:s,usdAmount:o}})).concat(b().chain(s).mapValues(e=>{let t=u.P[e.asset],s=m[e.vault],n=t&&s&&s.lpLiq&&s.lpBase&&s.lpQuote&&f[t.base]&&f[t.quote],l=n?(f[t.base]*s.lpBase+f[t.quote]*s.lpQuote)/s.lpLiq:f[e.asset]||c.Pq,a=(null==s?void 0:s.lpLiq)||(null==s?void 0:s.lockedAssetTotal)||0n;return{name:e.assetSymbol,symbol:e.assetSymbol,address:e.asset,price:l,amount:a,usdAmount:l*a/c.Pq}}).values().reduce((e,t)=>{let s=e.find(e=>e.symbol==t.symbol);return s?(s.amount+=t.amount,s.usdAmount+=t.usdAmount,e):[...e,t]},[]).value()),S=x.reduce((e,t)=>e+t.usdAmount,0n);return{tvl:S,tvlItems:x}}(),t=(0,p.useMemo)(()=>e.tvlItems.map(e=>[(0,n.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,n.jsx)(l.c,{symbol:e.symbol,size:20}),(0,n.jsx)("span",{children:e.symbol})]},"icon"),"$".concat((0,y.d)(e.price)),(0,y.d)(e.amount),"$".concat((0,y.d)(e.usdAmount))]),[e.tvlItems]);return(0,n.jsx)(DashItem,{title:"Total Value Locked",sub:"$".concat((0,y.d)(e.tvl)),tHeader:["Asset","NAV","Amount","Total"],tData:t})}function BVaultsItem(){let e=(0,d.p)(),t=(0,p.useMemo)(()=>r.Fw[e].filter(e=>(e.onEnv||[]).includes(c.Vi)),[e]),s=(0,h.o)(e=>e.sliceBVaultsStore.bvaults,["sliceBVaultsStore.bvaults"]),a=(0,h.o)(e=>e.sliceTokenStore.prices,["sliceTokenStore.prices"]),o=(0,p.useMemo)(()=>{let e=t.map(e=>{let t=(0,f.ok)(s,[e.vault,"lockedAssetTotal"]),n=t*(0,f.ok)(a,[e.asset])/c.Pq,l=u.P[e.asset];if(l){let t=(0,f.ok)(s,[e.vault,"lpBase"]),o=(0,f.ok)(s,[e.vault,"lpQuote"]);n=(t*(0,f.ok)(a,[l.base])+o*(0,f.ok)(a,[l.quote]))/c.Pq}let[o,r]=l?e.assetSymbol.split("-"):["",""],i=Math.max(22+5*(0,y.d)(t).length,5*(0,y.d)(n).length+5);return{bvc:e,totalDeposit:t,totalDepositUsd:n,totalLeftWidth:i,lp:l,baseSymbol:o,quoteSymbol:r}}),o=e.reduce((e,t)=>Math.max(e,t.totalLeftWidth),0)+20;return e.map(e=>{let{bvc:t,totalDeposit:a,totalDepositUsd:r,lp:u,baseSymbol:i,quoteSymbol:c}=e;return[(0,n.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,n.jsx)(l.c,{symbol:t.assetSymbol,size:20}),(0,n.jsx)("span",{children:t.assetSymbol})]},"icon"),(0,n.jsxs)("div",{className:"flex gap-8 items-start",children:[(0,n.jsxs)("div",{style:{width:o},children:[(0,n.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,n.jsx)(l.c,{symbol:t.assetSymbol,size:14}),(0,n.jsx)("span",{children:(0,y.d)(a)})]},"icon"),(0,n.jsxs)("div",{className:"opacity-60",children:["~",(0,y.d)(r)]})]}),u&&(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,n.jsx)(l.c,{symbol:i,size:14}),(0,n.jsx)("span",{children:(0,y.d)((0,f.ok)(s,[t.vault,"lpBase"]))})]},"icon"),(0,n.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,n.jsx)(l.c,{symbol:c,size:14}),(0,n.jsx)("span",{children:(0,y.d)((0,f.ok)(s,[t.vault,"lpQuote"]))})]},"icon")]})]},"total"),(0,n.jsxs)("div",{className:"flex gap-2 items-center",children:[P,(0,n.jsxs)("span",{children:["Epoch ",(0,f.ok)(s,[t.vault,"epochCount"]).toString()]})]},"status"),(0,n.jsx)(j.sp,{bvc:t},"apy"),"".concat((0,y.d)((0,S.pg)(t.vault),2),"X")]})},[t,s,a]);return(0,n.jsx)(DashItem,{title:"B-Vault",tHeader:["Vaults","Total Deposit","Status","PT APY","YT Boost"],tData:o})}function Dashboard(){return(0,m.a1)(),(0,m.Ev)(),(0,d.p)(),(0,n.jsx)(a.E,{children:(0,n.jsxs)("div",{className:"w-full max-w-[1200px] px-4 mx-auto flex flex-col gap-5 md:pb-8",children:[(0,n.jsx)(TVLItem,{}),(0,n.jsx)(BVaultsItem,{})]})})}},88439:function(e,t,s){"use strict";s.d(t,{b:function(){return useMemoOfChainId}});var n=s(64103),l=s(59175);function useMemoOfChainId(e){let t=(0,l.p)(),s=(0,n.useRef)({});return(0,n.useMemo)(()=>(s.current[t]||(s.current[t]=e()),s.current[t]),[t])}},45438:function(e,t,s){"use strict";s.d(t,{i:function(){return c},p:function(){return useUpdatePtypoolApy}});var n=s(19757),l=s(22139),a=s(55349),o=s(64103),r=s(33737),u=s(93108),i=s(59175);let c=(0,u.Ue)(e=>({update:e}));function useUpdatePtypoolApy(e){let t=(0,i.p)(),s=n.iK[t]||[],u=(0,a.o)(e=>e.sliceLVaultsStore.lvaults,["sliceLVaultsStore.lvaults"]);(0,o.useEffect)(()=>{console.info("updatePtypoolApy"),null==s||s.forEach(s=>{let a=u[s.vault];if(s.ptyPoolAboveAddress&&a&&a.sellPoolTotalStaking&&c.getState().update({[s.ptyPoolAboveAddress]:{staking:(0,r.v)("0.025",10),matching:0n}}),s.ptyPoolBelowAddress&&a&&a.buyPoolTotalStaking&&!a.isStable){let o=a&&a.sellPoolTotalStaking*e[n.O1[t]],r=o>0n&&a.settingsDecimals>0n?a.M_ETHx*a.Y*e[s.xTokenAddress]*l.Pq/2n/o/a.settingsDecimals**10n:0n;c.getState().update({[s.ptyPoolBelowAddress]:{staking:r*10n**10n/l.Pq,matching:0n}})}})},[s,u,e,t])}},15506:function(e,t,s){"use strict";s.d(t,{D2:function(){return useWandContractRead},uX:function(){return useWandContractReads}}),s(78403);var n=s(83978),l=s.n(n);s(64103);var a=s(30308),o=s(59307),r=s(93108);let u=(0,r.Ue)(e=>({time:l().now(),update:()=>{e({time:l().now()})}}));function useWandContractRead(e){let{time:t}=u();return(0,a.u)({...e,query:{placeholderData:e=>e,refetchOnMount:!1,refetchOnWindowFocus:!1,...e.query||{}},wandtime:t})}function useWandContractReads(e){let{time:t}=u();return(0,o.N)({...e,query:{placeholderData:e=>e,refetchOnMount:!1,refetchOnWindowFocus:!1,...e.query||{}},wandtime:t})}},52671:function(e,t,s){"use strict";s.d(t,{g:function(){return S},A:function(){return FetcherProvider}});var n=s(31113),l=s(19757),a=s(22139),o=s(59175),r=s(64103),u=s(25233),i=s(87958),c=s(41340),d=s(73216),m=s(88439),p=s(45438),v=s(26361),f=s(64370),h=s(55349),x=s(18358),b=s(39577);let S=(0,r.createContext)({prices:(0,v.Yb)({},0n),usbApr:{apr:0n,aprDecimals:10}}),FetcherProvider=e=>{let{children:t}=e;(0,x.d6)();let s=(0,o.p)();!function(){let{chainId:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,u.m)({chainId:e});r.useMemo(()=>(t&&(d.ON.provider=function(e){var t,s;let{chain:n,transport:l}=e,a={chainId:n.id,name:n.name,ensAddress:null===(s=n.contracts)||void 0===s?void 0:null===(t=s.ensRegistry)||void 0===t?void 0:t.address};return"fallback"===l.type?new i.H(l.transports.map(e=>{let{value:t}=e;return new c.r(null==t?void 0:t.url,a)})):new c.r(l.url,a)}(t)),d.ON.provider),[t])}();let y=(0,m.b)(()=>(0,v.Yb)({[l.O1[s]]:a.Pq},0n));(0,b.$$)(y);let k=(0,b.UM)();return(0,p.p)(y),(0,f.a)({queryKey:["updateDefTokenList",s],staleTime:36e5,queryFn:async()=>(await h.w.getState().sliceTokenStore.updateDefTokenList(),!0)}),(0,n.jsx)(S.Provider,{value:{prices:y,usbApr:k},children:t})}},39577:function(e,t,s){"use strict";s.d(t,{$$:function(){return useSetLVaultPrices},UM:function(){return useUSBApr},aS:function(){return useValutsLeverageRatio},hC:function(){return useLVault},hY:function(){return useUserLVault},so:function(){return useUpLVaultOnUserAction},z6:function(){return useVaultLeverageRatio}});var n=s(19757),l=s(22139),a=s(59175),o=s(88439),r=s(26361),u=s(55349),i=s(96670),c=s(73216);let d=(0,r.Yb)({vaultMode:0,discountEnable:!1},0n),m=(0,r.Yb)({},0n);function useLVault(e){return(0,u.o)(t=>t.sliceLVaultsStore.lvaults[e]||d,["sliceLVaultsStore.lvaults.".concat(e)])}function useUserLVault(e){return(0,u.o)(t=>t.sliceLVaultsStore.user[e]||m,["sliceLVaultsStore.user.".concat(e)])}function useVaultLeverageRatio(e){let t=useLVault(e.vault),s=(0,r.pF)(t.aar,t.AARDecimals);return Math.max(0,1+1/(s-1))}function useValutsLeverageRatio(){let e=(0,a.p)(),t=n.iK[e]||[],s=(0,o.b)(()=>(0,r.Yb)({},0)),l=(0,u.o)(e=>e.sliceLVaultsStore.lvaults);return null==t||t.forEach(e=>{let t=l[e.vault],n=t?(0,r.pF)(t.aar,t.AARDecimals):0;s[e.vault]=Math.max(0,1+1/(n-1))}),s}function useSetLVaultPrices(e){var t;let s=(0,u.o)(e=>e.sliceLVaultsStore.lvaults),o=(0,u.o)(e=>e.sliceTokenStore.totalSupply),r=(0,a.p)();null===(t=n.iK[r])||void 0===t||t.forEach(t=>{let a=s[t.vault]||d,u=a.assetBalance,i=a.latestPrice,c=a.usbTotalSupply,m=o[t.xTokenAddress]||0n,p=m>0n&&u>0n&&i>0n&&c>0n&&u*i>c*l.Pq?(u*i-c*l.Pq)/m:0n;e[t.xTokenAddress]=p,e[t.assetTokenAddress]=i,m>0n&&u>0n&&i>0n&&c>0n&&u*i<c*l.Pq&&(e[n.O1[r]]=u*i/c)})}function useUSBApr(){var e;let t=(0,a.p)(),s=(0,u.o)(e=>e.sliceLVaultsStore.lvaults),l=0,o=0n,r=0n;return null===(e=n.iK[t])||void 0===e||e.forEach(e=>{let t=s[e.vault]||d;t.isStable?(o+=t.M_USB_USDC*t.Y*t.aar/10n**t.AARDecimals,r+=t.M_USB_USDC,t.M_USB_USDC>0n&&t.Y>0n&&l++):(o+=t.M_USB_ETH*t.Y,r+=t.M_USB_ETH,t.M_USB_ETH>0n&&t.Y>0n&&l++)}),{apr:r>0n?o/r:0n,aprDecimals:10}}function useUpLVaultOnUserAction(e){let{address:t}=(0,i.m)();return()=>{(0,r.XD)(async()=>{if(!t)return;let s=u.w.getState().sliceLVaultsStore,l=[e.assetTokenAddress,e.xTokenAddress,n.O1[(0,c.BV)()]];await Promise.all([s.updateLVaults([e]),s.updateUserLVault(e,t),u.w.getState().sliceTokenStore.updateTokensBalance(l,t),u.w.getState().sliceTokenStore.updateTokenTotalSupply(l)])},3,1e3).catch(console.error)}}}},function(e){e.O(0,[4881,7495,7622,3113,4105,931,4300,359,6466,2653,7717,2487,7625,5228,6002,2536,3137,7093,604,1744],function(){return e(e.s=36599)}),_N_E=e.O()}]);