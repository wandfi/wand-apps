(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5444],{8631:function(t,e,s){Promise.resolve().then(s.bind(s,94234))},94234:function(t,e,s){"use strict";s.r(e),s.d(e,{default:function(){return Dashboard}});var n=s(31113),i=s(44939),a=s(75496),o=s(31889),r=s(99971);s(6371),s(19757);var u=s(59175),l=s(63126);s(39577),s(36602);var c=s(84944),h=s(8298),d=s(87031),p=s(22139),m=s(44020),f=s(18358),v=s(64103);s(83978);var x=s(69708),b=s(55746),S=s(59781),y=s(85593);function PortfolioItem(t){let{title:e,sub:s,tHeader:i,tData:o,tableProps:r}=t;return(0,n.jsxs)("div",{className:"card whitespace-nowrap",children:["string"==typeof e?(0,n.jsx)("div",{className:"text-2xl leading-none font-semibold",children:e}):e,"string"==typeof s?(0,n.jsx)("div",{className:"text-[2rem] text-primary leading-none font-semibold mt-2",children:s}):s,(0,n.jsx)("div",{className:"my-4 h-[1px] bg-border/60 dark:bg-border"}),(0,n.jsx)("div",{className:"w-full overflow-x-auto",children:(0,n.jsx)(a.ZP,{headerClassName:"border-b-0",tbodyClassName:"text-sm font-medium",header:i,data:o,...r||{}})})]})}function IconTitle(t){return(0,n.jsxs)("div",{className:"flex text-2xl leading-none font-semibold items-center gap-4",children:[(0,n.jsx)(r.c,{symbol:t.icon,size:32}),(0,n.jsx)("span",{children:t.tit})]})}function CoinText(t){return(0,n.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,n.jsx)(r.c,{symbol:t.symbol,size:t.size||20}),(0,n.jsx)("span",{children:t.txt||t.symbol})]})}function PrincipalItem(){let t=(0,x.useRouter)(),e=(0,u.p)(),s=(0,v.useMemo)(()=>d.Fw[e].filter(t=>(t.onEnv||[]).includes(p.Vi)),[e]),i=(0,v.useMemo)(()=>{let e=h.w.getState(),inRedeem=t=>(e.sliceUserBVaults.epoches[t.vault]||[]).reduce((t,e)=>t+e.redeemingBalance,0n),claimAble=t=>(e.sliceUserBVaults.epoches[t.vault]||[]).reduce((t,e)=>t+e.claimableAssetBalance,0n),yieldDay=t=>{let s=e.sliceTokenStore.balances[t.pToken]||0n;return(0,f.lL)(t)*s/10n**10n/365n},i=s.map(t=>{var s,n,i;let a=e.sliceTokenStore.balances[t.pToken]||0n,o=inRedeem(t),r=claimAble(t),u=a+o+r,l=m.P[t.asset],[h,d]=l?t.assetSymbol.split("-"):["",""],p=(null===(s=e.sliceBVaultsStore.bvaults[t.vault])||void 0===s?void 0:s.lpLiq)||0n,f=(null===(n=e.sliceBVaultsStore.bvaults[t.vault])||void 0===n?void 0:n.lpBase)||0n,v=(null===(i=e.sliceBVaultsStore.bvaults[t.vault])||void 0===i?void 0:i.lpQuote)||0n,x=l&&p&&f&&u?u*f/p:0n,b=l&&p&&v&&u?u*v/p:0n,S=(0,c.d)(u);return{bvc:t,pBalance:a,pRedeeming:o,pClaimAble:r,lp:l,baseSymbol:h,quoteSymbol:d,uBase:x,uQuote:b,pTotalUser:u,fmtTotalUser:S}}).filter(t=>t.pTotalUser>0n),a=i.reduce((t,e)=>Math.max(t,e.fmtTotalUser.length),0),o=Math.round(5*a+20);return i.map(e=>{let{bvc:s,pBalance:i,pRedeeming:a,pClaimAble:r,lp:u,fmtTotalUser:l,baseSymbol:h,quoteSymbol:d,uBase:p,uQuote:m}=e;return[(0,n.jsx)(CoinText,{symbol:s.assetSymbol,txt:s.pTokenSymbol,size:32},"coin"),(0,c.d)(i),(0,c.d)(a),(0,n.jsxs)("div",{className:"flex w-fit cursor-pointer items-center gap-2 underline",onClick:()=>(0,S.rc)(t,s.vault,"principal_panda","claim"),children:[(0,c.d)(r),(0,n.jsx)(b.HV3,{})]},"claim"),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("div",{style:{width:o},children:l}),u&&(0,n.jsxs)("div",{children:[(0,n.jsx)(CoinText,{size:14,symbol:h,txt:(0,c.d)(p)}),(0,n.jsx)(CoinText,{size:14,symbol:d,txt:(0,c.d)(m)})]})]},"total"),(0,n.jsx)(y.sp,{bvc:s},"apy"),(0,c.d)(yieldDay(s))]})},[s,h.w.getState()]);return(0,n.jsx)(PortfolioItem,{title:(0,n.jsx)(IconTitle,{tit:"Principal Token",icon:"PToken"}),tHeader:["","Balance","In Redemption","Claimable","Total Amount","APY","Est.Yield/day"],tData:i})}function BoostItem(){let t=(0,x.useRouter)(),e=(0,u.p)(),s=(0,v.useMemo)(()=>d.Fw[e].filter(t=>(t.onEnv||[]).includes(p.Vi)),[e]),i=(0,v.useMemo)(()=>{let e=h.w.getState(),epochInfo=(t,s)=>e.sliceBVaultsStore.epoches["".concat(t,"_").concat(s)],i=s.map(t=>{let s=e.sliceUserBVaults.epoches[t.vault]||[],n=s.map(s=>{var n;return{...s,epochInfo:epochInfo(t.vault,parseInt(s.epochId.toString())),settled:(null===(n=e.sliceBVaultsStore.epoches["".concat(t.vault,"_").concat(parseInt(s.epochId.toString()))])||void 0===n?void 0:n.settled)||!1}}).filter(t=>!!t.epochInfo);return{bvc:t,epochsData:n}}).filter(t=>t.epochsData.length);return i.map(e=>{let{bvc:s,epochsData:i}=e;return[(0,n.jsx)(CoinText,{symbol:s.assetSymbol,txt:s.yTokenSymbol,size:32},"coin"),(0,n.jsx)("div",{children:i.map(t=>(0,n.jsxs)("div",{className:"flex items-baseline",children:[(0,n.jsxs)("div",{className:"w-[4rem]",children:["Epoch ",t.epochId.toString()]}),(0,n.jsxs)("div",{className:"opacity-60 text-xs",children:[(0,l.G$)(1000n*t.epochInfo.startTime)," - ",(0,l.G$)((t.epochInfo.startTime+t.epochInfo.duration)*1000n)]})]},t.epochId.toString()))},"epochs"),(0,n.jsx)("div",{children:i.map(t=>(0,n.jsx)("div",{children:(0,c.d)(t.userBalanceYToken)},t.epochId.toString()))},"amount"),(0,n.jsx)("div",{children:i.map(t=>(0,n.jsx)("div",{children:(0,c.d)(t.userBalanceYTokenSyntyetic,void 0,23)},t.epochId.toString()))},"time weighted"),(0,n.jsx)("div",{children:i.map(e=>(0,n.jsx)("div",{children:e.settled?(0,n.jsxs)("div",{className:"flex w-fit cursor-pointer items-center gap-2 underline",onClick:()=>(0,S.rc)(t,s.vault,"boost_venom"),children:["Ready to Harvest",(0,n.jsx)(b.HV3,{})]},"claim"):"Ongoing"},e.epochId.toString()))},"status")]})},[s,h.w.getState()]);return(0,n.jsx)(PortfolioItem,{title:(0,n.jsx)(IconTitle,{tit:"Yield Token",icon:"YToken"}),tHeader:["","Epoch","YT Balance","YT Points","Status"],tData:i,tableProps:{cellClassName:(t,e)=>0==e?"flex flex-col":"leading-[30px]"}})}function Dashboard(){return(0,o.a1)(),(0,o.Ev)(),(0,o.z2)(),(0,o.g2)(),(0,u.p)(),(0,n.jsx)(i.E,{children:(0,n.jsxs)("div",{className:"w-full max-w-[1200px] px-4 mx-auto flex flex-col gap-5 md:pb-8",children:[(0,n.jsx)(PrincipalItem,{}),(0,n.jsx)(BoostItem,{})]})})}},88439:function(t,e,s){"use strict";s.d(e,{b:function(){return useMemoOfChainId}});var n=s(64103),i=s(59175);function useMemoOfChainId(t){let e=(0,i.p)(),s=(0,n.useRef)({});return(0,n.useMemo)(()=>(s.current[e]||(s.current[e]=t()),s.current[e]),[e])}},39577:function(t,e,s){"use strict";s.d(e,{$$:function(){return useSetLVaultPrices},UM:function(){return useUSBApr},aS:function(){return useValutsLeverageRatio},hC:function(){return useLVault},hY:function(){return useUserLVault},so:function(){return useUpLVaultOnUserAction},z6:function(){return useVaultLeverageRatio}});var n=s(19757),i=s(22139),a=s(59175),o=s(88439),r=s(63126),u=s(8298),l=s(96670),c=s(73216);let h=(0,r.Yb)({vaultMode:0,discountEnable:!1},0n),d=(0,r.Yb)({},0n);function useLVault(t){return(0,u.o)(e=>e.sliceLVaultsStore.lvaults[t]||h,["sliceLVaultsStore.lvaults.".concat(t)])}function useUserLVault(t){return(0,u.o)(e=>e.sliceLVaultsStore.user[t]||d,["sliceLVaultsStore.user.".concat(t)])}function useVaultLeverageRatio(t){let e=useLVault(t.vault),s=(0,r.pF)(e.aar,e.AARDecimals);return Math.max(0,1+1/(s-1))}function useValutsLeverageRatio(){let t=(0,a.p)(),e=n.iK[t]||[],s=(0,o.b)(()=>(0,r.Yb)({},0)),i=(0,u.o)(t=>t.sliceLVaultsStore.lvaults);return null==e||e.forEach(t=>{let e=i[t.vault],n=e?(0,r.pF)(e.aar,e.AARDecimals):0;s[t.vault]=Math.max(0,1+1/(n-1))}),s}function useSetLVaultPrices(t){var e;let s=(0,u.o)(t=>t.sliceLVaultsStore.lvaults),o=(0,u.o)(t=>t.sliceTokenStore.totalSupply),r=(0,a.p)();null===(e=n.iK[r])||void 0===e||e.forEach(e=>{let a=s[e.vault]||h,u=a.assetBalance,l=a.latestPrice,c=a.usbTotalSupply,d=o[e.xTokenAddress]||0n,p=d>0n&&u>0n&&l>0n&&c>0n&&u*l>c*i.Pq?(u*l-c*i.Pq)/d:0n;t[e.xTokenAddress]=p,t[e.assetTokenAddress]=l,d>0n&&u>0n&&l>0n&&c>0n&&u*l<c*i.Pq&&(t[n.O1[r]]=u*l/c)})}function useUSBApr(){var t;let e=(0,a.p)(),s=(0,u.o)(t=>t.sliceLVaultsStore.lvaults),i=0,o=0n,r=0n;return null===(t=n.iK[e])||void 0===t||t.forEach(t=>{let e=s[t.vault]||h;e.isStable?(o+=e.M_USB_USDC*e.Y*e.aar/10n**e.AARDecimals,r+=e.M_USB_USDC,e.M_USB_USDC>0n&&e.Y>0n&&i++):(o+=e.M_USB_ETH*e.Y,r+=e.M_USB_ETH,e.M_USB_ETH>0n&&e.Y>0n&&i++)}),{apr:r>0n?o/r:0n,aprDecimals:10}}function useUpLVaultOnUserAction(t){let{address:e}=(0,l.m)();return()=>{(0,r.XD)(async()=>{if(!e)return;let s=u.w.getState().sliceLVaultsStore,i=[t.assetTokenAddress,t.xTokenAddress,n.O1[(0,c.BV)()]];await Promise.all([s.updateLVaults([t]),s.updateUserLVault(t,e),u.w.getState().sliceTokenStore.updateTokensBalance(i,e),u.w.getState().sliceTokenStore.updateTokenTotalSupply(i)])},3,1e3).catch(console.error)}}},36602:function(t,e,s){"use strict";s.d(e,{A5:function(){return useTotalSupply},b7:function(){return useNftBalance},ln:function(){return useBalances}});var n=s(63126),i=s(8298);function useBalances(){return(0,i.o)(t=>(0,n.Yb)(t.sliceTokenStore.balances,0n),["sliceTokenStore.balances"])}function useNftBalance(t){return(0,i.o)(e=>e.sliceTokenStore.nftBalance[t]||[],["sliceTokenStore.nftBalance.".concat(t)])}function useTotalSupply(t){return(0,i.o)(e=>{var s;return null!==(s=e.sliceTokenStore.totalSupply[t])&&void 0!==s?s:0n},["sliceTokenStore.totalSupply.".concat(t)])}},83716:function(t,e,s){"use strict";s.d(e,{R:function(){return getDefaultState},m:function(){return o}});var n=s(64583),i=s(93242),a=s(76937),o=class extends i.F{#t;#e;#s;constructor(t){super(),this.mutationId=t.mutationId,this.#e=t.mutationCache,this.#t=[],this.state=t.state||getDefaultState(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){this.#t.includes(t)||(this.#t.push(t),this.clearGcTimeout(),this.#e.notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){this.#t=this.#t.filter(e=>e!==t),this.scheduleGc(),this.#e.notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){this.#t.length||("pending"===this.state.status?this.scheduleGc():this.#e.remove(this))}continue(){return this.#s?.continue()??this.execute(this.state.variables)}async execute(t){this.#s=(0,a.Mz)({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(Error("No mutationFn found")),onFail:(t,e)=>{this.#n({type:"failed",failureCount:t,error:e})},onPause:()=>{this.#n({type:"pause"})},onContinue:()=>{this.#n({type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#e.canRun(this)});let e="pending"===this.state.status,s=!this.#s.canStart();try{if(!e){this.#n({type:"pending",variables:t,isPaused:s}),await this.#e.config.onMutate?.(t,this);let e=await this.options.onMutate?.(t);e!==this.state.context&&this.#n({type:"pending",context:e,variables:t,isPaused:s})}let n=await this.#s.start();return await this.#e.config.onSuccess?.(n,t,this.state.context,this),await this.options.onSuccess?.(n,t,this.state.context),await this.#e.config.onSettled?.(n,null,this.state.variables,this.state.context,this),await this.options.onSettled?.(n,null,t,this.state.context),this.#n({type:"success",data:n}),n}catch(e){try{throw await this.#e.config.onError?.(e,t,this.state.context,this),await this.options.onError?.(e,t,this.state.context),await this.#e.config.onSettled?.(void 0,e,this.state.variables,this.state.context,this),await this.options.onSettled?.(void 0,e,t,this.state.context),e}finally{this.#n({type:"error",error:e})}}finally{this.#e.runNext(this)}}#n(t){this.state=(e=>{switch(t.type){case"failed":return{...e,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...e,isPaused:!0};case"continue":return{...e,isPaused:!1};case"pending":return{...e,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...e,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...e,data:void 0,error:t.error,failureCount:e.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}})(this.state),n.V.batch(()=>{this.#t.forEach(e=>{e.onMutationUpdate(t)}),this.#e.notify({mutation:this,type:"updated",action:t})})}};function getDefaultState(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}},95499:function(t,e,s){"use strict";s.d(e,{D:function(){return useMutation}});var n=s(64103),i=s(83716),a=s(64583),o=s(7539),r=s(72549),u=class extends o.l{#i;#a=void 0;#o;#r;constructor(t,e){super(),this.#i=t,this.setOptions(e),this.bindMethods(),this.#u()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){let e=this.options;this.options=this.#i.defaultMutationOptions(t),(0,r.VS)(this.options,e)||this.#i.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#o,observer:this}),e?.mutationKey&&this.options.mutationKey&&(0,r.Ym)(e.mutationKey)!==(0,r.Ym)(this.options.mutationKey)?this.reset():this.#o?.state.status==="pending"&&this.#o.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#o?.removeObserver(this)}onMutationUpdate(t){this.#u(),this.#l(t)}getCurrentResult(){return this.#a}reset(){this.#o?.removeObserver(this),this.#o=void 0,this.#u(),this.#l()}mutate(t,e){return this.#r=e,this.#o?.removeObserver(this),this.#o=this.#i.getMutationCache().build(this.#i,this.options),this.#o.addObserver(this),this.#o.execute(t)}#u(){let t=this.#o?.state??(0,i.R)();this.#a={...t,isPending:"pending"===t.status,isSuccess:"success"===t.status,isError:"error"===t.status,isIdle:"idle"===t.status,mutate:this.mutate,reset:this.reset}}#l(t){a.V.batch(()=>{if(this.#r&&this.hasListeners()){let e=this.#a.variables,s=this.#a.context;t?.type==="success"?(this.#r.onSuccess?.(t.data,e,s),this.#r.onSettled?.(t.data,null,e,s)):t?.type==="error"&&(this.#r.onError?.(t.error,e,s),this.#r.onSettled?.(void 0,t.error,e,s))}this.listeners.forEach(t=>{t(this.#a)})})}},l=s(83037),c=s(17275);function useMutation(t,e){let s=(0,l.NL)(e),[i]=n.useState(()=>new u(s,t));n.useEffect(()=>{i.setOptions(t)},[i,t]);let o=n.useSyncExternalStore(n.useCallback(t=>i.subscribe(a.V.batchCalls(t)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),r=n.useCallback((t,e)=>{i.mutate(t,e).catch(c.Z)},[i]);if(o.error&&(0,c.L)(i.options.throwOnError,[o.error]))throw o.error;return{...o,mutate:r,mutateAsync:o.mutate}}}},function(t){t.O(0,[4881,5294,7495,7622,3113,4105,2882,4300,9637,6466,2653,6087,2487,8959,1749,8298,3047,4090,5593,7093,604,1744],function(){return t(t.s=8631)}),_N_E=t.O()}]);