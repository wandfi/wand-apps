(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4317],{97049:function(e,s,t){"use strict";t.d(s,{r:function(){return a.Z}});var a=t(62653)},95127:function(e,s,t){Promise.resolve().then(t.bind(t,79326))},79326:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return Vaults}});var a=t(52628),l=t(67039),n=t(3107),i=t(51767),r=t(6194),d=t(4605),o=t(90947),c=t(85665);function useElementSizeCheck(e){let[s,t]=(0,c.Z)();return[s,e(t)]}var m=t(11944),u=t(83508);let x={};var p=t(19532),b=t(16248),h=t(15493),v=t(69275),f=t(2360),g=t(38946),k=t(62653),j=t(33501),T=t(11292),y=t(6951),S=t(51966),N=t(98589),w=t(19671),A=t(51830);function FmtPercent(e){let{className:s,value:t,decimals:l,showDecimals:n=2,plusI0:i=!0}=e,r=0n==t?0n:t||0n,d=i?r>=0n:r>0n,o=null==t||void 0==t||"bigint"!=typeof t;return(0,a.jsx)("span",{className:(0,h.cn)(s,d?"text-[#42FF37]":"text-[#F3474C]"),children:o?"-%":(0,a.jsxs)(a.Fragment,{children:[d&&"+",(0,h.Jh)(r,l,n)]})})}var B=t(81183),M=t(83084);function WrapDiv(e){let{children:s,wrap:t,...l}=e;return t?(0,a.jsx)("div",{...l,children:s}):s}var P=t(88966),W=t(36437),R=t(70475);function TokenValue(e){let{symbol:s,value:t,decimals:l}=e;return(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(w.c,{className:"inline-block",size:16,symbol:s}),(0,f.d)(t,l)]})}function PoolCard(e){let{type:s,vc:t}=e,l="buy"==s,n=(0,o.p)(),c=l?r.O1[n]:t.assetTokenAddress,C=l?t.assetTokenAddress:t.xTokenAddress,V=l?r.TW:t.assetTokenSymbol,_=l?t.assetTokenSymbol:r.TW,F=l?"Buy ".concat(t.assetTokenSymbol," Low"):"Sell ".concat(t.assetTokenSymbol," High"),D=l?t.ptyPoolBelowAddress:t.ptyPoolAboveAddress,{prices:U,usbApr:E}=(0,u.useContext)(v.g),L=(0,W.ln)(),q=(0,P.hC)(t.vault),z=(0,P.hY)(t.vault),{address:K}=(0,y.m)(),Z=L[c],[O,H]=(0,u.useState)(""),I=(0,h.su)(O),Y=l?t.xTokenSymbol:t.assetTokenSymbol,J=l?t.assetTokenSymbol:t.xTokenSymbol,$=l?q.buyPoolTotalStaking:q.sellPoolTotalStaking,X=l?z.buyPool_userStakingBalance:z.sellPool_userStakingBalance;(0,u.useMemo)(()=>$*(0,h.ok)(U,c,d.Pq)/d.Pq,[U[c],$]);let G=l?q.AARS:q.AARU,Q=q.assetBalance,ee=q.usbTotalSupply,es=(0,u.useMemo)(()=>G&&q.AARDecimals&&0n!=Q&&0n!=ee?G*ee*d.Pq/q.AARDecimals/Q/BigInt(1e9):(0,h.ok)(U,t.assetTokenAddress),[G,ee,q.AARDecimals,Q]),et=l?"Stake $USB, and when the ".concat(t.assetTokenSymbol," price falls to the target, it will trigger the purchase of ").concat(t.assetTokenSymbol," with staked $USB."):"Stake ".concat(t.assetTokenSymbol,", and when the ").concat(t.assetTokenSymbol," price rises to the target, staked ").concat(t.assetTokenSymbol," will be sold."),ea=(0,p.D2)({abi:i.aT,address:D,functionName:"getAccruedMatchingYields"}),el=(0,h.ok)(ea,"data"),en=(0,u.useMemo)(()=>{let e=$;if(q.isStable||0n==e||0n==U[c])return"0.00%";let s=10n**(q.AARDecimals||10n),t=(q.AART-s)*es;if(0n==t)return"0.00%";let a=l?(q.AART*q.M_USB_ETH*d.Pq-q.M_ETH*es*s)/(q.AART-s)/d.Pq:(q.M_ETH*es*s-q.AART*q.M_USB_ETH*d.Pq)/t;return(e=(0,h.NA)([e,a]))*U[c]>0n?(0,h.Jh)(el*U[C]*d.Pq/(e*U[c]),18,3):"0.00%"},[q.isStable,el,C,c,U[C],U[c],l]),ei=(0,m.i)(),er=(0,h.ok)(ei[D],"staking"),ed=U[t.assetTokenAddress]>0&&es>0n?l?(U[t.assetTokenAddress]-es)*10n**10n/U[t.assetTokenAddress]:(es-U[t.assetTokenAddress])*10n**10n/U[t.assetTokenAddress]:0n,eo=(0,u.useMemo)(()=>{if(q.isStable)return 0n;let e=10n**(q.AARDecimals||10n),s=(q.AART-e)*es/e;if(0n==s)return 0n;if(l){let t=(q.AART*q.M_USB_ETH*d.Pq-q.M_ETH*es*e)/e/s,a=t*es/d.Pq,l=z.buyPool_userStakingBalance,n=q.buyPoolTotalStaking>a&&a>=0n?l*a/q.buyPoolTotalStaking:l;return n}{let t=(q.M_ETH*es*e-q.AART*q.M_USB_ETH*d.Pq)/e/s,a=z.sellPool_userStakingBalance,l=q.sellPoolTotalStaking>t&&t>=0n?a*t/q.sellPoolTotalStaking:a;return l}},[q.isStable,z,q,l,es]),ec=(0,u.useMemo)(()=>{let e=l?[{key:"eth_price",label:"".concat(t.assetTokenSymbol," Price"),value:(0,f.d)(U[t.assetTokenAddress])},{key:"target_price",label:"Target Price",value:(0,a.jsxs)("div",{children:[(0,f.d)(es)," (",(0,a.jsx)(FmtPercent,{value:ed<0n?void 0:-ed,decimals:10,plusI0:!1}),")"]}),groupEnd:!0},{key:"apr_interest",label:"APY",value:(0,h.Jh)(E.apr+er,E.aprDecimals,2),detail:(0,a.jsxs)("div",{className:"pl-2",children:[(0,a.jsxs)("div",{children:["~",r.TW," Interest: ",(0,h.Jh)(E.apr,E.aprDecimals,2)]}),(0,a.jsxs)("div",{children:["~",Y," Yield: ",(0,h.Jh)(er,E.aprDecimals,2)]})]}),groupEnd:!0},{key:"transacation_reward_pool",label:"Reward Pool",tip:"The reward funds originates from protocol, and when a purchase action is triggered, these funds will be distributed proportionally.",value:(0,a.jsx)(TokenValue,{symbol:J,value:el})},{key:"discount_rate",label:"Reward Rate",tip:"This is an estimated value, to be determined upon triggering. Reward Rate =Reward/Transaction volume",value:"".concat(en," (Est.)")}]:[{key:"eth_price",label:"".concat(t.assetTokenSymbol," Price"),value:(0,f.d)(U[t.assetTokenAddress])},{key:"target_price",label:"Target Price",value:(0,a.jsxs)("div",{children:[(0,f.d)(es)," (",(0,a.jsx)(FmtPercent,{value:ed<0n?void 0:ed,decimals:10,plusI0:!0}),")"]}),groupEnd:!0},{key:"apr_yield",label:"APY(".concat(Y," Yield)"),value:(0,h.Jh)(er,E.aprDecimals,2),groupEnd:!0},{key:"transacation_reward_pool",label:"Reward Pool",tip:"The reward funds originates from protocol, and when a sell action is triggered, these funds will be distributed proportionally.",value:(0,a.jsx)(TokenValue,{symbol:J,value:el})},{key:"discount_rate",label:"Reward Rate",tip:"This is an estimated value, to be determined upon triggering. Reward Rate =Reward/Transaction volume",value:"".concat(en," (Est.)")}];return e},[el]),em=(0,u.useMemo)(()=>{let e=l?[{key:"successfully_brought",label:"Successfully Bought",value:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(TokenValue,{symbol:_,value:z.buyPool_earnedMatchedToken}),(0,a.jsx)("span",{children:"+"}),(0,a.jsx)(TokenValue,{symbol:J,value:z.buyPool_earnedMatchingYields}),(0,a.jsx)(M.C,{inFlex:!0,children:"From Reward Pool"})]})},{key:"staking_earend",label:"".concat(Y," Earned"),value:(0,a.jsx)(TokenValue,{symbol:Y,value:z.buyPool_earnedStakingYields})}]:[{key:"successfully_sold",label:"Successfully Sold",value:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(TokenValue,{symbol:_,value:z.sellPool_earnedMatchedToken}),(0,a.jsx)("span",{children:"+"}),(0,a.jsx)(TokenValue,{symbol:J,value:z.sellPool_earnedMatchingYields}),(0,a.jsx)(M.C,{inFlex:!0,children:"From Reward Pool"})]})}];return e},[z,_,Y,J]),eu=(0,P.so)(t),{write:ex,isDisabled:ep,isLoading:eb}=(0,b.R)({abi:i.aT,address:D,functionName:"claimAll"}),eh=function(e){let s=(0,u.useRef)(null);return x[e]&&x[e].includes(s)||(x[e]=[...x[e]||[],s]),(0,u.useEffect)(()=>{if(!s.current)return()=>{};let onResize=()=>{let t=x[e]||[],a=t.reduce((e,s)=>{var t;return Math.max((null===(t=s.current)||void 0===t?void 0:t.clientHeight)||0,e)},0);t.filter(e=>e!=s).forEach(e=>{var s;let t=(null===(s=e.current)||void 0===s?void 0:s.clientHeight)||0;t!==a&&a>0&&e.current&&(e.current.style.height="".concat(a,"px"))})};return window.addEventListener("resize",onResize),onResize(),()=>{window.removeEventListener("resize",onResize)}},[s.current]),s}(t.vault),[ev,ef]=useElementSizeCheck(e=>{let{width:s}=e;return s<512});return(0,a.jsxs)("div",{className:"card flex flex-col",ref:ev,children:[(0,a.jsxs)("div",{className:"flex gap-5 items-center justify-between",ref:eh,children:[(0,a.jsxs)("div",{className:"flex gap-3 md:gap-5 items-center",children:[(0,a.jsxs)("div",{className:"relative w-fit shrink-0",children:[(0,a.jsx)(w.c,{size:32,symbol:V,className:"md:hidden"}),(0,a.jsx)(w.c,{size:40,symbol:V,className:"hidden md:block"}),(0,a.jsx)(w.c,{size:16,symbol:_,className:"absolute -right-1 -bottom-1 md:hidden"}),(0,a.jsx)(w.c,{size:24,symbol:_,className:"absolute -right-2 -bottom-2 hidden md:block"})]}),(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("h6",{className:"page-sub",children:F||"title"}),(0,a.jsx)(M.C,{children:et})]})})]}),(0,a.jsx)(WrapDiv,{wrap:ef,className:"flex flex-col-reverse gap-1 items-end",children:(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"text-xs text-black/60 dark:text-white/60 font-medium text-right",children:["Total ",V," Staked"]}),(0,a.jsx)("div",{className:"text-base text-black dark:text-slate-50 text-end font-semibold",children:(0,f.d)($)})]})})]}),(0,a.jsx)(g.Z,{className:"my-4 h-[1px] dark:bg-zinc-600 "}),(0,a.jsxs)(k.Z,{numItemsSm:2,className:"flex-1",children:[(0,a.jsx)(k.Z,{numItemsSm:1,className:"gap-y-2 gap-x-7 sm:border-r-[1px] border-[#E4E4E7] dark:border-zinc-600 mb-3 md:mb-0 ",children:null==ec?void 0:ec.map(e=>(0,a.jsxs)("div",{className:(0,j.Z)("flex flex-col text-sm",{"mb-4":e.groupEnd}),children:[(0,a.jsxs)("div",{className:"flex items-center flex-wrap",children:[(0,a.jsxs)("div",{className:"text-black dark:text-slate-50 font-medium mr-[5px]",children:[e.label," : ",e.tip&&(0,a.jsx)(M.C,{children:e.tip})]}),(0,a.jsx)("div",{className:"text-neutral-900 dark:text-slate-50 ml-2",children:e.value})]}),e.detail]},e.key))}),K&&(0,a.jsxs)(k.Z,{numItemsSm:1,className:"gap-x-1 pl-2",children:[(0,a.jsx)("div",{className:"w-full border-t-[1px] border-[#E4E4E7] dark:border-zinc-600 sm:border-0 sm:px-[0px]",children:null==em?void 0:em.map(e=>(0,a.jsxs)("div",{className:"flex items-center flex-wrap mt-[8px] sm:mt-0 sm:mb-2",children:[(0,a.jsxs)("div",{className:"text-xs text-black dark:text-slate-50 whitespace-nowrap font-medium mr-[5px]",children:[e.label," :"]}),(0,a.jsx)("div",{className:"text-neutral-900 dark:text-slate-50 text-sm shrink-0 ml-2",children:e.value})]},e.key))}),(0,a.jsxs)("div",{className:"mt-auto h-fit",children:[(0,a.jsx)("div",{className:"w-full flex justify-center items-center",children:(0,a.jsx)(R.k6,{className:"flex items-center w-[60%] md:w-fit self-end justify-center gap-4 bg-[#64738B]",disabled:ep||eb,onClick:()=>ex().then(eu),children:(0,a.jsxs)("div",{className:"flex px-10 py-2 gap-4 items-center whitespace-nowrap",children:[eb&&(0,a.jsx)(B.$,{}),(0,a.jsx)("span",{children:"Claim All"})]})})}),(0,a.jsxs)("div",{className:"relative flex flex-col gap-1 mt-4 md:mt-[28px] justify-center items-center text-[#64748B] text-sm font-medium p-3 rounded-md bg-slate-100 dark:bg-transparent dark:text-slate-50",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:["Staked",(0,a.jsx)(w.c,{symbol:V,size:16}),(0,f.d)(X),(0,a.jsx)("span",{className:"text-primary ml-[5px] cursor-pointer",onClick:()=>H((0,T.d)(X)),children:"Max"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1 pl-8",children:["-",(0,f.d)(eo),(0,a.jsxs)(M.C,{inFlex:!0,children:["This is the amount of staked ",V," that will be ",l?"spent":"sold"," when price triggers."]})]})]})]})]})]}),K?(0,a.jsxs)("div",{className:"mt-4 md:mt-[30px]",children:[(0,a.jsx)(N.W,{amount:O,setAmount:H,asset:V,balance:Z,checkBalance:!1}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(S.v,{tx:"Stake",disabled:I<=0n||I>Z,onTxSuccess:()=>{H(""),eu()},config:{abi:i.aT,address:D,functionName:"stake",args:[I],value:V==r.Ku?I:0n},className:"mt-2 w-[calc(50%-10px)] !mx-0",approves:{[c]:I},spender:D}),(0,a.jsx)(S.v,{className:"mt-2 w-[calc(50%-10px)] !mx-0",tx:"Withdraw",disabled:I<=0n||I>X,onTxSuccess:()=>{H(""),eu()},config:{abi:i.aT,address:D,functionName:"withdraw",args:[I]}})]})]}):(0,a.jsx)("div",{className:"w-full flex items-center justify-center mt-[30px]",children:(0,a.jsx)(A.Z,{})})]})}var C=t(84633),V=t(44945),_=t(88501);let ValutArea=e=>{let{asset:s}=e,t=(0,o.p)(),l=r.iK[t],n=l.find(e=>e.assetTokenSymbol==s),i=(0,P.hC)(n.vault),d=n.assetTokenSymbol,c=i.discountEnable,m=c?"Discount available":"No discount",x=!c,{rate:p}=useDiscountRate(n),[b,v]=(0,u.useMemo)(()=>{if(i.isStable){let toPercent=e=>(100*Math.max(0,Math.min(1,(e-1)/1))).toFixed(2)+"%",e=(0,h.pF)(i.AARS,i.AARDecimals),s=(0,h.pF)(i.aar,i.AARDecimals);return[toPercent(s),toPercent(e)]}{let e=(0,h.pF)(i.AARU,i.AARDecimals),s=(0,h.pF)(i.aar,i.AARDecimals),t=(0,h.pF)(i.AARS,i.AARDecimals),a=(0,h.pF)(i.AART,i.AARDecimals),l=e/2,toPercent=s=>(100*Math.max(0,Math.min(1,(s-l)/(e-l)))).toFixed(2)+"%",n=toPercent(s);return x?[n,toPercent(t)]:[n,toPercent(a)]}},[n.isStable,i,x]),f=(0,h.Rr)(i.aar,i.AARDecimals),g=i.isStable?(0,h.Rr)(i.AARS,i.AARDecimals):x?(0,h.Rr)(i.AARS,i.AARDecimals):(0,h.Rr)(i.AART,i.AARDecimals),k="px-2 py-1 bg-primary rounded font-medium text-black",j=(0,a.jsxs)("div",{style:{position:"relative",left:b,transform:"translate(-50%,0)"},className:"flex flex-col items-center w-fit rounded-md",children:[(0,a.jsxs)("div",{className:"text-xs flex flex-col gap-2 justify-center items-center",children:[(0,a.jsx)("span",{className:"text-neutral-400 whitespace-nowrap",children:"Current AAR"}),(0,a.jsx)("span",{className:k,children:f})]}),(0,a.jsx)("svg",{width:"10",height:"8",viewBox:"0 0 10 8",xmlns:"http://www.w3.org/2000/svg",className:"fill-primary",fill:"currentColor",children:(0,a.jsx)("path",{d:"M5 7.5L0.669873 -7.57104e-07L9.33013 0L5 7.5Z"})})]}),T=(0,a.jsxs)("div",{style:{position:"relative",left:v,transform:"translate(-50%,0)"},className:"flex flex-col items-center w-fit rounded-md",children:[(0,a.jsx)("svg",{className:"rotate-180 fill-primary",width:"10",height:"8",viewBox:"0 0 10 8",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{d:"M5 7.5L0.669873 -7.57104e-07L9.33013 0L5 7.5Z"})}),(0,a.jsxs)("div",{className:"text-xs flex flex-col gap-2 justify-center items-center",children:[(0,a.jsxs)("span",{className:k,children:["AAR=",g]}),(0,a.jsx)("span",{className:"text-neutral-400 whitespace-nowrap",children:x?"Trigger discount":"Discount end"})]})]});return(0,a.jsxs)("div",{className:"bg-white border border-neutral-200 rounded-3xl flex-1 flex flex-col gap-5 justify-center p-4 w-full md:mb-[30px] dark:bg-transparent dark:border-zinc-600",children:[(0,a.jsx)("div",{className:"h-fit",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(w.c,{symbol:n.assetTokenSymbol,size:32,className:"mr-[10px] md:hidden"}),(0,a.jsx)(w.c,{symbol:n.assetTokenSymbol,size:54,className:"mr-[10px] hidden md:block"}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-md md:text-xl font-bold",children:[d," Vault"]}),(0,a.jsxs)("div",{className:"text-xs flex items-center gap-2",children:[!c&&(0,a.jsxs)("div",{className:"flex items-center text-neutral-700 dark:text-slate-50 gap-1",children:[(0,a.jsx)("div",{className:(0,_.m)("w-3 h-3 shrink-0 rounded-full",c?"bg-red-500":"bg-green-500")}),m]}),c&&(0,a.jsxs)("div",{className:"text-sm flex items-center gap-2",children:[(0,a.jsx)("div",{className:(0,_.m)("w-3 h-3 shrink-0 rounded-full bg-red-500")})," Discount Rate: ",p]})]})]})]})}),(0,a.jsxs)("div",{className:"w-full p-4 rounded-lg flex flex-col gap-2",children:[j,(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"rounded-full shrink-0 w-[3px] h-[3px] bg-[#64748B] dark:bg-primary"}),(0,a.jsx)("div",{className:"h-px flex-1 bg-[#64748B] dark:bg-primary after:content-['AAR'] after:inline-block after:text-right after:w-full after:text-xs after:text-[#64748B] dark:after:text-slate-50"}),(0,a.jsx)("div",{className:"rounded-full shrink-0 w-[3px] h-[3px] bg-[#64748B] dark:bg-primary"})]}),T]})]})};function useDiscountRate(e){let{prices:s}=(0,u.useContext)(v.g),t=(0,o.p)(),{data:a}=(0,p.D2)({abi:i.Wn,address:r.O6[t],functionName:e.isStable?"calcUsbToMarginTokensForStableVault":"calcUsbToMarginTokens",args:[e.vault,r.e_[t],(0,h.su)("1")]}),l=(0,h.ok)(a,[1]),n=(0,u.useMemo)(()=>0n==l?0n:(0,h.su)("1")*d.Pq/l,[l]),c=(0,u.useMemo)(()=>{let t=s[e.xTokenAddress];return!t||0n==t||0n==n||n>=t?"0.00%":(0,h.Jh)((t-n)*d.Pq/t,18,2)},[s[e.xTokenAddress],n]);return{rate:c,oneUsbXoutValue:l}}function LVaultsDiscount(e){let{vc:s}=e,{prices:t}=(0,u.useContext)(v.g),n=(0,W.ln)(),c=(0,P.hC)(s.vault),m=(0,o.p)(),x=(0,u.useMemo)(()=>r.iK[m].filter(e=>!e.disableIn),[m]),p=(0,u.useMemo)(()=>x.map(e=>({value:e.vault,label:e.xTokenSymbol})),[x]),[b,g]=(0,u.useState)(p[0]),k=p.find(e=>e===b)?b:p[0],j=c.discountEnable,T=(0,h.ok)(t,s.xTokenAddress),y=n[r.O1[m]],[w,A]=(0,u.useState)(""),B=(0,h.su)(w),M=0n!=B&&B<=y&&j,{rate:R,oneUsbXoutValue:C}=useDiscountRate(s),_=C*B/d.Pq,F=(0,P.so)(s);return(0,a.jsxs)("div",{className:"",children:[(0,a.jsx)(l.K,{data:"Due to fluctuations in the prices of collateral, when the AAR decreases, the protocol will offer users the opportunity to purchase xToken at a discount with ".concat(r.TW,". This means that you can engage in arbitrage.")}),(0,a.jsxs)("div",{className:"grid grid-cols-1 mt-5 gap-2 md:grid-cols-10 md:gap-8 md:mt-8",children:[(0,a.jsx)("div",{className:"w-full min-h-full col-span-4 flex flex-col gap-4",children:x.map(e=>(0,a.jsx)(ValutArea,{asset:e.assetTokenSymbol},"vault_area_".concat(e.assetTokenSymbol)))}),(0,a.jsxs)("div",{className:"w-full col-span-6 bg-white border border-neutral-200 p-4 mb-4 md:p-[30px] md:pt-[60px] rounded-3xl md:mb-[30px] dark:bg-transparent dark:border-zinc-600",children:[(0,a.jsxs)("div",{className:"flex flex-col items-center gap-2 w-full mx-auto",children:[(0,a.jsx)(N.W,{asset:r.TW,amount:w,setAmount:A,balance:y,exchange:(0,f.d)(B*(0,h.ok)(t,r.O1[m],d.Pq)/d.Pq)}),(0,a.jsxs)("div",{className:"flex items-center justify-center w-full",children:[(0,a.jsx)("div",{className:"flex-1"}),(0,a.jsx)(V.gPZ,{className:"w-6 h-6 text-neutral-500  border border-neutral-200 rounded-full my-[10px]"}),(0,a.jsx)("div",{className:"flex-1"})]}),(0,a.jsxs)("div",{className:"w-full flex-1 text-right text-neutral-700 dark:text-slate-50/60 text-md whitespace-nowrap",children:["Discount Rate: ",j?R:"--"]}),(0,a.jsx)(N.W,{asset:k.label,options:p,amount:(0,f.d)(_),exchange:(0,f.d)(T*_/d.Pq),readonly:!0,defaultValue:p[0],onChange:e=>{console.log(e),g(e)}})]}),(0,a.jsx)(S.v,{tx:"Swap",className:"!w-full mt-6",disabled:!M,onTxSuccess:()=>{A(""),F()},config:{abi:i.WW,address:s.vault,functionName:"usbToMarginTokens",args:[B],enabled:M},approves:{[r.O1[m]]:B},spender:s.vault})]})]})]})}var F=t(766),D=t(86026),U=t(64370),E=t(97049),L=t(38762),q=t(58409);function LVaultAdvance(e){let{vc:s}=e,{prices:t}=(0,u.useContext)(v.g),l=(0,W.ln)(),n=(0,P.hC)(s.vault),c=(0,o.p)(),m=r.O6[c],x=n.vaultMode,[b,g]=(0,u.useState)("Mint"),[k,j]=(0,u.useMemo)(()=>{let e="Mint"==b;return 3==x?["Adjustment Model--High AAR",e?"Minting ".concat(r.TW," alone is feasible"):"Redeeming ".concat(s.xTokenSymbol," alone is feasible")]:2==x?["Adjustment Model--Low AAR",e?"Minting ".concat(s.xTokenSymbol," alone is feasible"):"Redeeming ".concat(r.TW," alone is feasible")]:["Stability Model",e?"".concat(r.TW," and ").concat(s.xTokenSymbol," will be minted in fixed ratio"):"Redemption require a fixed ration of ".concat(r.TW," and ").concat(s.xTokenSymbol)]},[x,s,b]),[y,w]=(0,u.useState)(""),[A,B]=(0,u.useState)(""),R=(0,h.ok)(t,s.assetTokenAddress),F=(0,h.ok)(t,s.xTokenAddress),D=l[s.assetTokenAddress],U=l[r.O1[c]],E=l[s.xTokenAddress],[{usbAmount:L,xAmount:z,redeemActive:K,redeemFocus:Z},O]=(0,q.Z)({usbAmount:"",xAmount:"",redeemActive:"",redeemFocus:r.TW}),H=(0,u.useMemo)(()=>({contracts:[{vc:s,abi:i.Wn,address:m,functionName:"calcMintPairs",args:[s.vault,(0,h.su)(y||"0")]},{vc:s,abi:i.Wn,address:m,functionName:"calcMintUsbAboveAARU",args:[s.vault,(0,h.su)(y||"0")]},{vc:s,abi:i.Wn,address:m,functionName:"calcMintMarginTokensBelowAARS",args:[s.vault,(0,h.su)(y||"0")]}],watch:!0,enabled:"Mint"==b}),[s,y,b]),{data:[I,Y,J]=[void 0,void 0,void 0]}=(0,p.uX)(H),$=(0,h.ok)(I,["result",1]),X=(0,h.ok)(I,["result",2]),G=(0,h.ok)(Y,["result",1]),Q=(0,h.ok)(J,["result",1]),{data:[ee,es]=[void 0,void 0]}=(0,p.uX)({contracts:[{vc:s,abi:i.Wn,address:m,functionName:"calcPairdMarginTokenAmount",args:[s.vault,(0,h.su)(L||"0")]},{vc:s,abi:i.Wn,address:m,functionName:"calcPairedUsbAmount",args:[s.vault,(0,h.su)(z||"0")]}],query:{enabled:"Redeem"==b}}),{data:[et,ea]=[void 0,void 0]}=(0,p.uX)({contracts:[{vc:s,abi:i.Wn,address:m,functionName:"calcRedeemByMarginTokenAboveAARU",args:[s.vault,(0,h.su)(z||"0")]},{vc:s,abi:i.Wn,address:m,functionName:"calcRedeemByUsbBelowAARS",args:[s.vault,(0,h.su)(L||"0")]}],query:{enabled:"Redeem"==b}}),el=(0,h.ok)(ee,["result"]),en=(0,h.ok)(es,["result"]),ei=(0,h.ok)(et,["result",1]),er=(0,h.ok)(ea,["result",1]),ed=K==s.xTokenSymbol,eo=K==r.TW,ec=(0,u.useMemo)(()=>{let e={abi:i.WW,address:s.vault,args:[(0,h.su)(y)],value:s.assetTokenAddress==r.K8?(0,h.su)(y):0n,functionName:"mintPairs"};return A==r.TW&&(e.functionName="mintUsbAboveAARU"),A==s.xTokenSymbol&&(e.functionName="mintMarginTokensBelowAARS"),e},[x,A,y,s]),em=A==s.xTokenSymbol?0n:A===r.TW?G:$,eu=A==r.TW?0n:A===s.xTokenSymbol?Q:X,ex=ed?"0":Z==r.TW?L:(0,T.d)(en),ep=eo?"0":Z==s.xTokenSymbol?z:(0,T.d)(el),eb=(0,u.useMemo)(()=>({vc:s,watch:!0,abi:i.Wn,address:m,functionName:"calcPairedRedeemAssetAmount",args:[s.vault,(0,h.su)(ep||"0")]}),[s,ep]),{data:eh}=(0,p.D2)(eb),ev=ed?ei:eo?er:(0,h.ok)(eh,[1]),ef=(0,u.useMemo)(()=>{let e={abi:i.WW,address:s.vault,functionName:K==r.TW?"redeemByPairsWithExpectedUsbAmount":"redeemByPairsWithExpectedMarginTokenAmount",args:K==r.TW?[(0,h.su)(ex)]:[(0,h.su)(ep)]};return K==s.xTokenSymbol&&(e.functionName="redeemByMarginTokenAboveAARU",e.args=[(0,h.su)(ep)]),K==r.TW&&(e.functionName="redeemByUsbBelowAARS",e.args=[(0,h.su)(ex)]),e},[x,K,ex,ep,s]),eg=(0,P.so)(s);return(0,a.jsxs)("div",{className:(0,_.m)("card relative h-[480px]",x>1?"!bg-violet-500/10":""),children:[(0,a.jsx)("div",{className:"page-sub text-center",children:"Advanced Panel"}),(0,a.jsx)("div",{className:"absolute top-[50px] right-6 flex flex-col items-end z-10",children:(0,a.jsxs)("div",{className:(0,_.m)("text-sm leading-5 flex items-center gap-1.5 rounded-full w-fit"),children:[(0,a.jsx)("div",{className:(0,_.m)("w-3 h-3 rounded-full","Stability Model"==k?"bg-green-500":"bg-red-500")}),(0,a.jsx)(M.C,{node:(0,a.jsx)("div",{className:(0,_.m)("Stability Model"==k?"text-green-500":"text-red-500"),children:k}),children:j})]})}),(0,a.jsx)("div",{className:"relative flex items-center justify-between",children:(0,a.jsx)(C.x,{onTabChange:g,data:[{tab:"Mint",content:(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)(N.W,{asset:s.assetTokenSymbol,exchange:(0,f.d)(R*(0,h.su)(y)/d.Pq),balance:D,amount:y,setAmount:w}),(0,a.jsx)("div",{className:"w-8 h-8 mx-auto flex items-center justify-center text-slate-400 rounded-full border border-slate-200 mb-6",children:(0,a.jsx)(V.gPZ,{})}),(0,a.jsxs)("div",{className:"flex flex-col gap-8",children:[(0,a.jsx)(N.W,{amount:(0,h.Kl)(em),onClick:()=>{B(3==x?r.TW:"")},asset:r.TW,exchange:(0,f.d)(em),readonly:!0,disable:x<=1,selected:A===r.TW}),(0,a.jsx)(N.W,{amount:(0,h.Kl)(eu),onClick:()=>{B(2==x?s.xTokenSymbol:"")},asset:s.xTokenSymbol,exchange:(0,f.d)(F*eu/d.Pq),readonly:!0,disable:x<=1,selected:A===s.xTokenSymbol})]}),(0,a.jsx)(S.v,{tx:"Mint",className:"mt-6 w-full",disabled:s.disableIn||0n==(0,h.su)(y)||(0,h.su)(y)>D,onTxSuccess:()=>{w(""),eg()},config:ec,approves:{[s.assetTokenAddress]:(0,h.su)(y)},spender:s.vault})]})},{tab:"Redeem",content:(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)(N.W,{amount:ex,setAmount:e=>O({usbAmount:e}),balance:U,onClick:()=>{O({redeemActive:2==x?r.TW:"",redeemFocus:r.TW})},asset:r.TW,exchange:(0,f.d)((0,h.su)(ex)),readonly:K==s.xTokenSymbol,selected:K===r.TW}),(0,a.jsx)(N.W,{amount:ep,setAmount:e=>O({xAmount:e}),asset:s.xTokenSymbol,onClick:()=>{O({redeemActive:3==x?s.xTokenSymbol:"",redeemFocus:s.xTokenSymbol})},exchange:(0,f.d)((0,h.su)(ep)*F/d.Pq),balance:E,readonly:K==r.TW,selected:K===s.xTokenSymbol})]}),(0,a.jsxs)("div",{className:"flex w-full items-center mb-6",children:[(0,a.jsx)("div",{className:"flex-1"}),(0,a.jsx)("div",{className:"w-8 h-8 mx-auto flex items-center justify-center text-slate-400 rounded-full border border-slate-200 ",children:(0,a.jsx)(V.gPZ,{})}),(0,a.jsx)("div",{className:"flex-1 text-sm text-slate-400 text-end whitespace-nowrap",children:"Redemption Fee: 0.5%"})]}),(0,a.jsx)("div",{className:"w-full text-end"}),(0,a.jsx)(N.W,{asset:s.assetTokenSymbol,amount:(0,T.d)(ev),exchange:(0,f.d)(R*ev/d.Pq),readonly:!0}),(0,a.jsx)(S.v,{tx:"Redeem",className:"mt-6 w-full",config:ef,disabled:eo&&0n==(0,h.su)(ex)||ed&&0n==(0,h.su)(ep)||!eo&&!ed&&(0n==(0,h.su)(ex)||0n==(0,h.su)(ep))||(0,h.su)(ex)>U||(0,h.su)(ep)>E,onTxSuccess:()=>{O({usbAmount:"",xAmount:""}),eg()},spender:s.vault})]})}]})})]})}var z=t(6062),K=t(25495),Z=t(33737);function useTokenApys(){let e=(0,K.b)(()=>(0,h.Yb)({},0n)),s=(0,o.p)(),{prices:t,usbApr:a}=(0,u.useContext)(v.g),l=(0,P.aS)(),n=(0,m.i)(),i=(0,D.o)(e=>e.sliceLVaultsStore.lvaults,["sliceLVaultsStore.lvaults"]);return(0,u.useMemo)(()=>{let t=r.iK[s]||[],d=(0,h.ok)(n[t[0].ptyPoolBelowAddress],"staking");e[r.O1[s]]=a.apr,e.USB_END=a.apr+d;let o=(0,Z.v)("0.1",10);return t.forEach(s=>{let t=i[s.vault];if(s.assetTokenAddress!=r.K8&&t){let a=l[s.vault]>1n?(0,Z.v)("".concat((l[s.vault]-1).toFixed(2)),10):0n,n=(0,Z.v)("1",10);e[s.xTokenAddress]=(a*(o-t.Y*t.aar/n)+o*n)/n}}),null},[s,t,l,a,n]),e}var O=t(79132),H=t(55746),I=t(36602),Y=t(50548),J=t(84570),$=t(42341),X=t(84774),G=t(26559),Q=t(52346),ee=t(89998);let es={Bera:X.Z,Bull:G.Z,Panda:Q.Z,Venom:ee.Z,BeraLine:X.Z,BullLine:G.Z,PandaLine:Q.Z,VenomLine:ee.Z};var et=t(54648);let ea={ZUSD:"#FFD3C2",ZUSD_dark:"#FFD3C2",xiBGT:"#AFD3FF",xiBGT_dark:"#AFD3FF",xBERA:"#AFD3FF",xBERA_dark:"#AFD3FF"},el={ZUSD:"#FFA973",xiBGT:"#93B0FF",xBERA:"#93B0FF"};function PointCard(e){let{symbol:s,symbolPrice:t,iconSymbol:l,tit:n,sub:i,total:r,link:d}=e,o=(0,et.l)(e=>e.theme),c=es[l];return(0,a.jsxs)("div",{style:{},className:"card overflow-hidden !p-0 text-base flex flex-col",children:[(0,a.jsxs)("div",{className:"flex md:flex-wrap items-center p-4 gap-2 dark:text-black",style:{background:ea["".concat(s,"_").concat(o)]||ea[s]},children:[(0,a.jsx)(c,{showBg:!0,className:"text-[2.625rem] shrink-0 dark:text-white text-black"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-semibold",children:s}),(0,a.jsx)("div",{className:"font-medium text-xs",children:t})]}),(0,a.jsxs)("div",{className:"whitespace-nowrap text-center text-sm ml-auto flex flex-col items-center flex-1",children:[(0,a.jsx)("div",{className:"rounded-full px-2 py-[2px] w-fit",style:{background:el[s]},children:n}),(0,a.jsx)("div",{className:"mt-1",children:i})]})]}),(0,a.jsxs)("div",{className:"flex justify-between p-4 whitespace-nowrap text-sm items-center gap-2",children:[(0,a.jsx)("div",{className:"font-medium text-slate-500 dark:text-slate-50/60 self-start text-xs items-center gap-1",children:(0,a.jsx)("span",{className:"font-semibold text-sm",children:r})}),d&&(0,a.jsxs)("a",{className:"underline text-slate-500 dark:text-slate-50 flex items-center gap-1",href:d.url,target:"_blank",children:[d.text," ",(0,a.jsx)(Y.Ig3,{})]})]})]})}function PointCards(e){let{vc:s}=e,t=function(e){let s=(0,o.p)(),{prices:t,usbApr:a}=(0,u.useContext)(v.g),l=(0,P.hC)(e.vault),n=(0,P.aS)(),i=(0,m.i)(),d=useTokenApys(),c=(0,u.useMemo)(()=>{let a=[],i=l.isStable?l.M_USB_USDC:l.M_USB_ETH,o=l.isStable?l.M_USDCx:l.M_ETHx;t[r.K8];let c=t[r.O1[s]];a.push({symbol:r.TW,symbolPrice:"$".concat((0,f.d)(c)),iconSymbol:"Bera",tit:"APY:".concat((0,h.Jh)(d[r.O1[s]],10)," ~ ").concat((0,h.Jh)(d.USB_END,10)),sub:"~ Interest + Earning",total:"Total Minted: ".concat((0,f.d)(i,0))});let m=e.isStable&&(0,z.re)()?"~ ".concat(n[e.vault].toFixed(2),"x Berachain Native Yield"):"~ ".concat(n[e.vault].toFixed(2),"x Leveraged long on ").concat(e.assetTokenSymbol);return a.push({symbol:e.xTokenSymbol,symbolPrice:"$".concat((0,f.d)(t[e.xTokenAddress])),iconSymbol:"Bull",tit:"Leverage the Bull",sub:m,total:"Total Minted: ".concat((0,f.d)(o,0))}),a},[s,t,n,a,i]);return c}(s),[l,n]=useElementSizeCheck(e=>{let{width:s}=e;return s<970});return 0==t.length?null:(0,a.jsxs)("div",{ref:l,className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[!n&&t.map(e=>(0,a.jsx)(PointCard,{...e},e.symbol)),n&&(0,a.jsx)($.tq,{spaceBetween:20,pagination:{clickable:!0,renderBullet:function(e,s){return'<div class="'+s+'"></div>'}},className:"-translate-x-[1rem] !px-4 !pb-10 !w-screen",modules:[J.tl],children:t.map(e=>(0,a.jsx)($.o5,{children:(0,a.jsx)(PointCard,{...e})},e.symbol))})]})}var en=t(82053);function StableLVaultAdvance(e){let{vc:s}=e,t=(0,o.p)(),{prices:l}=(0,u.useContext)(v.g),n=r.O6[t],[c,m]=(0,u.useState)("Mint"),[x,b]=(0,u.useState)(""),[g,k]=(0,u.useState)(""),j=(0,P.hC)(s.vault),y=j.aar>0&&j.aar<j.AARS,w=j.latestPrice,A=l[s.xTokenAddress],B=(0,W.ln)(),R=B[s.assetTokenAddress]||0n,F=B[r.O1[t]]||0n,D=B[s.xTokenAddress]||0n,[{usbAmount:U,xAmount:E,redeemActive:L,redeemFocus:z},K]=(0,q.Z)({usbAmount:"",xAmount:"",redeemActive:"",redeemFocus:r.TW}),Z=(0,u.useMemo)(()=>({contracts:[{vc:s,abi:i.Wn,address:n,functionName:"calcMintPairsFromStableVault",args:[s.vault,(0,h.su)(x||"0")]},{vc:s,abi:i.Wn,address:n,functionName:"calcMintUsbFromStableVault",args:[s.vault,(0,h.su)(x||"0")]},{vc:s,abi:i.Wn,address:n,functionName:"calcMintMarginTokensFromStableVault",args:[s.vault,(0,h.su)(x||"0")]}],watch:!0,enabled:"Mint"==c}),[s,x,c]),{data:[O,H,I]=[void 0,void 0,void 0]}=(0,p.uX)(Z),Y=(0,h.ok)(O,["result",1]),J=(0,h.ok)(O,["result",2]),$=(0,h.ok)(H,["result",1]),X=(0,h.ok)(I,["result",1]),{data:[G,Q]=[void 0,void 0]}=(0,p.uX)({contracts:[{vc:s,abi:i.Wn,address:n,functionName:"calcPairdMarginTokenAmountForStableVault",args:[s.vault,(0,h.su)(U||"0")]},{vc:s,abi:i.Wn,address:n,functionName:"calcPairedUsbAmountForStableVault",args:[s.vault,(0,h.su)(E||"0")]}],query:{enabled:"Redeem"==c}}),{data:[ee,es]=[void 0,void 0]}=(0,p.uX)({contracts:[{vc:s,abi:i.Wn,address:n,functionName:"calcRedeemByMarginTokensFromStableVault",args:[s.vault,r.e_[t],(0,h.su)(E||"0")]},{vc:s,abi:i.Wn,address:n,functionName:"calcRedeemByUsbFromStableVault",args:[s.vault,r.e_[t],(0,h.su)(U||"0")]}],query:{enabled:"Redeem"==c}}),et=(0,h.ok)(G,["result"]),ea=(0,h.ok)(Q,["result"]),el=(0,h.ok)(ee,["result",1]),en=(0,h.ok)(es,["result",1]),ei=L==s.xTokenSymbol,er=L==r.TW,ed=(0,u.useMemo)(()=>{let e={abi:i.S4,address:s.vault,functionName:"mintPairs",args:[(0,h.su)(x)],value:s.assetTokenAddress==r.K8?(0,h.su)(x):0n};return g==r.TW&&(e.functionName="mintUsb"),g==s.xTokenSymbol&&(e.functionName="mintMarginTokens"),e},[g,x,s]),eo=g==s.xTokenSymbol?0n:g===r.TW?$:Y,ec=g==r.TW?0n:g===s.xTokenSymbol?X:J,em=ei?"0":z==r.TW?U:(0,T.d)(ea),eu=er?"0":z==s.xTokenSymbol?E:(0,T.d)(et),ex=(0,u.useMemo)(()=>({vc:s,watch:!0,abi:i.Wn,address:n,functionName:"calcRedeemByPairsAssetAmountForStableVault",args:[s.vault,r.e_[t],(0,h.su)(eu||"0")]}),[s,eu]),{data:ep}=(0,p.D2)(ex),eb=ei?el:er?en:(0,h.ok)(ep,[1]),eh=(0,u.useMemo)(()=>{let e={abi:i.S4,address:s.vault,functionName:L==r.TW?"redeemByPairsWithExpectedUsbAmount":"redeemByPairsWithExpectedMarginTokenAmount",args:L==r.TW?[(0,h.su)(em)]:[(0,h.su)(eu)]};return L==s.xTokenSymbol&&(e.functionName="redeemByMarginTokens",e.args=[(0,h.su)(eu)]),L==r.TW&&(e.functionName="redeemByUsb",e.args=[(0,h.su)(em)]),e},[L,em,eu,s]),ev=(0,P.so)(s);return(0,a.jsxs)("div",{className:(0,_.m)("card relative h-[480px]"),children:[(0,a.jsx)("div",{className:"page-sub text-center",children:"Advanced Panel"}),(0,a.jsx)("div",{className:"absolute top-[50px] right-6 flex flex-col items-end z-10",children:(0,a.jsx)(M.C,{node:(0,a.jsxs)("div",{className:(0,_.m)("text-sm leading-5 flex items-center gap-1.5 rounded-full w-fit"),children:[(0,a.jsx)("div",{className:(0,_.m)("w-3 h-3 rounded-full",y?"bg-red-500":"bg-green-500")}),(0,a.jsx)("div",{className:(0,_.m)(y?"text-red-500":"text-green-500"),children:y?"Adjustment Model":"Stability Model"})]}),children:y?"Mint"==c?"Minting ".concat(r.TW," alone is not feasible"):"Redeeming USDBx alone is not feasible":""})}),(0,a.jsx)("div",{className:"relative flex items-center justify-between",children:(0,a.jsx)(C.x,{onTabChange:m,data:[{tab:"Mint",content:(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)(N.W,{asset:s.assetTokenSymbol,exchange:(0,f.d)(w*(0,h.su)(x)/d.Pq),balance:R,amount:x,setAmount:b}),(0,a.jsx)("div",{className:"w-8 h-8 mx-auto flex items-center justify-center text-slate-400 rounded-full border border-slate-200 mb-6",children:(0,a.jsx)(V.gPZ,{})}),(0,a.jsxs)("div",{className:"flex flex-col gap-8",children:[(0,a.jsx)(N.W,{amount:(0,h.Kl)(eo),onClick:()=>{k(y?"":g==r.TW?"":r.TW)},asset:r.TW,exchange:(0,f.d)(eo),readonly:!0,selected:g===r.TW}),(0,a.jsx)(N.W,{amount:(0,h.Kl)(ec),onClick:()=>{k(g==s.xTokenSymbol?"":s.xTokenSymbol)},asset:s.xTokenSymbol,exchange:(0,f.d)(A*ec/d.Pq),readonly:!0,selected:g===s.xTokenSymbol})]}),(0,a.jsx)(S.v,{tx:"Mint",className:"mt-6 w-full",disabled:s.disableIn||0n==(0,h.su)(x)||(0,h.su)(x)>R,onTxSuccess:()=>{b(""),ev()},config:ed,approves:{[s.assetTokenAddress]:(0,h.su)(x)},spender:s.vault})]})},{tab:"Redeem",content:(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)(N.W,{amount:em,setAmount:e=>K({usbAmount:e}),balance:F,onClick:()=>{K({redeemActive:L==r.TW?"":r.TW,redeemFocus:r.TW})},asset:r.TW,exchange:(0,f.d)((0,h.su)(em)),readonly:L==s.xTokenSymbol,selected:L===r.TW}),(0,a.jsx)(N.W,{amount:eu,setAmount:e=>K({xAmount:e}),asset:s.xTokenSymbol,onClick:()=>{K({redeemActive:y?"":L==s.xTokenSymbol?"":s.xTokenSymbol,redeemFocus:s.xTokenSymbol})},exchange:(0,f.d)((0,h.su)(eu)*A/d.Pq),balance:D,readonly:L==r.TW,selected:L===s.xTokenSymbol})]}),(0,a.jsxs)("div",{className:"flex w-full items-center mb-6",children:[(0,a.jsx)("div",{className:"flex-1"}),(0,a.jsx)("div",{className:"w-8 h-8 mx-auto flex items-center justify-center text-slate-400 rounded-full border border-slate-200 ",children:(0,a.jsx)(V.gPZ,{})}),(0,a.jsx)("div",{className:"flex-1 text-sm text-slate-400 text-end whitespace-nowrap",children:"Redemption Fee: 0.5%"})]}),(0,a.jsx)("div",{className:"w-full text-end"}),(0,a.jsx)(N.W,{asset:s.assetTokenSymbol,amount:(0,T.d)(eb),exchange:(0,f.d)(w*eb/d.Pq),readonly:!0}),(0,a.jsx)(S.v,{tx:"Redeem",className:"mt-6 w-full",config:eh,disabled:er&&0n==(0,h.su)(em)||ei&&0n==(0,h.su)(eu)||!er&&!ei&&(0n==(0,h.su)(em)||0n==(0,h.su)(eu))||(0,h.su)(em)>F||(0,h.su)(eu)>D,onTxSuccess:()=>{K({usbAmount:"",xAmount:""}),ev()},spender:s.vault})]})}]})})]})}var ei=t(93063),er=t(35496);let ed=(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",children:(0,a.jsx)("circle",{cx:"7",cy:"7",r:"5",fill:"white",stroke:"#00DE9C",strokeWidth:"4"})}),eo=(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",children:(0,a.jsx)("circle",{cx:"7",cy:"7",r:"5",fill:"white",stroke:"#FF3D3D",strokeWidth:"4"})}),ec=(0,a.jsx)("div",{className:"mr-[10px]",children:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"5",height:"5",viewBox:"0 0 5 5",fill:"none",children:(0,a.jsx)("circle",{cx:"2.5",cy:"2.5",r:"2.5",fill:"#64748B"})})});function VaultSimple(e){let{vc:s}=e,{prices:t}=(0,u.useContext)(v.g),l=(0,W.ln)(),n=(0,h.ok)(t,s.assetTokenAddress),c=(0,P.hC)(s.vault),m=c.vaultMode,x=s.assetTokenSymbol,[b,g]=(0,u.useState)(""),k=(0,h.su)(b),j=s.xTokenSymbol,T=l[s.assetTokenAddress],[y,A]=(0,u.useState)(""),B=(0,o.p)(),{data:R}=(0,p.D2)({abi:i.Wn,address:r.O6[B],functionName:s.isStable?"calcMintPairsFromStableVault":"calcMintPairs",args:[s.vault,(0,h.su)("1")]}),{data:V}=(0,p.D2)({abi:i.Wn,address:r.O6[B],functionName:"calcMintMarginTokensFromStableVault",args:[s.vault,(0,h.su)("1")],query:{enabled:s.isStable}}),_=s.isStable&&c.isStable&&0n==c.M_USDCx?0n:(0,h.ok)(R,[1]),F=s.isStable&&c.isStable&&0n==c.M_USDCx?(0,h.ok)(V,[1]):(0,h.ok)(R,[2]),D=l[r.O1[B]],U=l[s.xTokenAddress],E=(0,h.NA)([F>0n?U*d.Pq/F:0n,_>0n?D*d.Pq/_:0n]),L=(0,h.su)(y),q=(0,u.useMemo)(()=>{let e={abi:s.isStable?i.S4:i.WW,address:s.vault,functionName:"redeemByPairsWithExpectedMarginTokenAmount",args:[L*F/d.Pq]};return e},[m,L,F,s]),z=(0,P.so)(s);return(0,a.jsxs)("div",{className:"w-full relative flex items-center justify-between",children:[(0,a.jsx)(en.o,{trigger:(0,a.jsxs)("div",{className:"absolute w-fit h-[21px] right-2 top-3 flex items-center gap-1 cursor-pointer",children:[(0,a.jsx)(H.b9P,{className:"text-primary text-xl"}),(0,a.jsx)(M.C,{inFlex:!0,className:" text-slate-500",children:s.isStable?"The advanced panel allows for the individual Minting or Redeeming of ".concat(r.TW," and ").concat(s.xTokenSymbol,"."):"More flexible operations can be conducted using the advanced panel in adjustment mode."})]}),children:s.isStable?(0,a.jsx)(StableLVaultAdvance,{vc:s}):(0,a.jsx)(LVaultAdvance,{vc:s})}),(0,a.jsx)(C.x,{data:[{tab:"Deposit",content:(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)(N.W,{asset:x,exchange:(0,f.d)(n*k/d.Pq),balance:T,amount:b,setAmount:g}),(0,a.jsxs)("div",{className:"text-xs text-[#64748B] dark:text-slate-50/60 leading-[12px] flex items-center pl-[5px] mt-[6px]",children:["1 ",(0,a.jsx)(w.c,{className:"mx-1",symbol:x,size:12}),x," = ",(0,f.d)(F)," ",(0,a.jsx)(w.c,{className:"mx-1",symbol:j,size:12})," ",j," +",(0,f.d)(_)," ",(0,a.jsx)(w.c,{className:"mx-1",symbol:r.TW,size:12})," ",r.TW]}),(0,a.jsx)(S.v,{tx:"Deposit",className:(0,h.cn)(s.isStable?"":"md:mt-11","mx-auto mt-6"),disabled:s.disableIn||k<=0n||k>T,onTxSuccess:()=>{g(""),z()},config:{abi:i.S4,address:s.vault,args:[k],value:s.assetTokenAddress==r.K8?k:0n,functionName:s.isStable&&c.isStable&&0n==c.M_USDCx?"mintMarginTokens":"mintPairs"},approves:{[s.assetTokenAddress]:k},spender:s.vault})]})},{tab:"Withdraw",content:(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("div",{className:"flex flex-col gap-2",children:(0,a.jsx)(N.W,{amount:y,setAmount:A,balance:E,balanceTit:"Redeemable amount",asset:x,exchange:(0,f.d)(n*L/d.Pq)})}),(0,a.jsxs)("div",{className:"text-xs text-[#64748B] dark:text-slate-50/60 leading-[12px] md:flex md:items-center md:justify-between pl-[5px] mt-[6px]",children:[(0,a.jsxs)("span",{className:"flex",children:[j," Balanceï¼š",(0,a.jsx)(w.c,{className:"mx-1",symbol:j,size:12})," ",(0,f.d)(U)]}),(0,a.jsxs)("span",{className:(0,h.cn)("flex relative"),children:[r.TW," Balance: ",(0,a.jsx)(w.c,{className:"mx-1",symbol:r.TW,size:12})," ",(0,f.d)(D)]})]}),!s.isStable&&(0,a.jsxs)("div",{className:"mt-2 text-center text-xs text-slate-500 dark:text-slate-50/70 relative md:text-right ",children:["Maintaining ",r.TW," balance greater than your Margin",(0,a.jsx)("br",{className:"hidden md:block"}),"Loan allows you to redeem your total Open Position"]}),(0,a.jsx)(S.v,{tx:"Withdraw",className:(0,h.cn)({"md:mt-1":!s.isStable},"mx-auto mt-6"),config:q,disabled:0n==_||0n==F||L<=0n||L>E,onTxSuccess:()=>{console.info("Redeem onSuccess:"),A(""),z()},spender:s.vault})]})}]})]})}function LVaultSimpleWrap(e){let{vc:s}=e,t=(0,o.p)(),l=(0,P.z6)(s),{address:n}=(0,y.m)(),i=(0,P.hC)(s.vault),d=i.isStable?i.M_USDC:i.M_ETH,c=i.isStable?i.M_USDCx:i.M_ETHx,m=i.isStable?i.M_USB_USDC:i.M_USB_ETH,u=(0,W.ln)(),x=c>0n?u[s.xTokenAddress]*d/c:0n,p=c>0n?-(u[s.xTokenAddress]*m)/c:0n,{data:b}=(0,I.p)();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(PointCards,{vc:s}),(0,a.jsxs)("div",{className:"w-full flex flex-col md:flex-row gap-5",children:[(0,a.jsxs)("div",{className:"min-h-[108px] flex flex-col justify-center shrink-0",children:[n&&!s.isStable&&(0,a.jsxs)("div",{className:"card h-[84px] w-full p-[20px] shrink-0 text-[#64748B] dark:text-slate-50/60 text-xs font-medium leading-[12px] rounded-2xl mb-5 whitespace-nowrap",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-[16px] gap-5",children:[(0,a.jsx)("div",{children:"Open Position"}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(w.c,{className:"mr-1",symbol:s.assetTokenSymbol,size:12}),(0,f.d)(x)]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between mb-[16px] gap-5",children:[(0,a.jsxs)("div",{children:["Margin Loan",(0,a.jsxs)(M.C,{children:["Repay your margin loan to redeem ",s.assetTokenSymbol," corresponding to your open position."]})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(w.c,{className:"mr-1",symbol:r.TW,size:12}),(0,f.d)(p)]})]})]}),(0,a.jsxs)("div",{className:"card text-[#64748B] w-full flex-1 dark:text-slate-50/60 text-xs font-medium leading-[12px] px-[30px] py-[23px] rounded-2xl",children:[(0,a.jsxs)("div",{className:"flex items-center mb-[16px] whitespace-nowrap",children:[ec,l.toFixed(2),"x ",(0,z.re)()&&s.isStable?"Blast Native Yield":"Leveraged long on ".concat(s.assetTokenSymbol)]}),(0,a.jsxs)("div",{className:"flex items-center mb-[16px] cursor-pointer whitespace-nowrap",onClick:()=>{s&&(null==b||b.watchAsset({type:"ERC20",options:{address:s.xTokenAddress,symbol:s.xTokenSymbol,decimals:18}}).catch(h.S3))},children:[ec,"Add ",s.xTokenSymbol," to wallet"]}),(0,a.jsxs)("div",{className:"flex items-center mb-[16px] cursor-pointer whitespace-nowrap",onClick:()=>{null==b||b.watchAsset({type:"ERC20",options:{address:r.O1[t],symbol:r.TW,decimals:18}}).catch(h.S3)},children:[ec,"Add ",r.TW," to wallet"]}),(0,a.jsxs)("div",{className:"flex items-center cursor-pointer whitespace-nowrap",onClick:()=>{var e,a;let l=z.Af.find(e=>e.id==t);l&&s&&open("".concat(null===(a=l.blockExplorers)||void 0===a?void 0:null===(e=a.default)||void 0===e?void 0:e.url,"/address/").concat(s.vault),"_blank")},children:[ec,"View contract"]})]})]}),(0,a.jsx)("div",{className:"card w-full",children:n&&s&&42==s.vault.length?(0,a.jsx)(VaultSimple,{vc:s}):s&&42==s.vault.length?(0,a.jsx)(A.Z,{}):(0,a.jsx)(O.Z,{className:"rounded",children:"Comming soon"})})]})]})}function LVaultCard(e){let{vc:s}=e,t=(0,L.useRouter)(),l=(0,o.p)(),n=(0,P.hC)(s.vault),i=(0,P.z6)(s),c=n.latestPrice,m=n.isStable?n.M_USDC:n.M_ETH,u=n.isStable?n.M_USDCx:n.M_ETHx,x=n.isStable?n.M_USB_USDC:n.M_USB_ETH,p=(0,f.d)(m),b=(0,f.d)(u),v=useTokenApys();(0,f.d)(m*c/d.Pq);let g=(0,f.d)(x),k=(0,h.Rr)(n.aar,n.AARDecimals),j=n.vaultMode,T=s.xTokenSymbol,y="py-5 flex flex-col items-center gap-2 relative dark:border-border border-solid";return(0,a.jsxs)("div",{className:(0,h.cn)("card cursor-pointer !p-0 grid grid-cols-2 overflow-hidden",{"order-1":!s.assetTokenSymbol.includes("ETH")}),onClick:()=>(0,er.kQ)(t,s.vault),children:[(0,a.jsxs)("div",{className:(0,h.cn)(y,"border-b","bg-black/10 dark:bg-white/10 col-span-2 flex-row px-4 md:px-5 py-4 items-center"),children:[(0,a.jsx)(w.c,{symbol:s.assetTokenSymbol,size:44}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:" text-lg font-semibold whitespace-nowrap",children:s.assetTokenSymbol}),(0,a.jsxs)("div",{className:" text-sm font-medium",children:["$",(0,f.d)(c)]})]}),(0,a.jsxs)("div",{className:"ml-auto",children:[(0,a.jsx)("div",{className:"text-[#64748B] dark:text-slate-50/60 text-xs font-semibold whitespace-nowrap",children:"Total Deposit"}),(0,a.jsx)("div",{className:"text-sm font-medium",children:p})]})]}),(0,a.jsxs)("div",{className:(0,h.cn)(y,"border-b border-r"),children:[(0,a.jsx)("div",{className:"text-[#64748B] dark:text-slate-50/60 text-xs font-semibold leading-[12px] whitespace-nowrap",children:"Status"}),(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)("span",{className:" text-[14px] leading-[14px] font-medium",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"mr-[10px]",children:j<=1?ed:eo}),j<=1?"Stability":"Adjustment"]})})})]}),(0,a.jsxs)("div",{className:(0,h.cn)(y,"border-b"),children:[(0,a.jsxs)("div",{className:"text-[#64748B] dark:text-slate-50/60 text-xs font-semibold leading-[12px] whitespace-nowrap",children:[T,(0,a.jsx)(M.C,{children:"This is a margin token, representing open position in the vault."})]}),(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)("span",{className:" text-[14px] leading-[14px] font-medium ml-[5px]",children:b})})]}),(0,a.jsxs)("div",{className:(0,h.cn)(y,"border-b border-r"),children:[(0,a.jsxs)("div",{className:"text-[#64748B] dark:text-slate-50/60 text-xs font-semibold leading-[12px] whitespace-nowrap",children:["AAR",(0,a.jsx)(M.C,{children:"Asset Adequacy Ratio"})]}),(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)("span",{className:" text-[14px] leading-[14px] font-medium",children:k})})]}),(0,a.jsxs)("div",{className:(0,h.cn)(y,"border-b"),children:[(0,a.jsxs)("div",{className:"text-[#64748B] dark:text-slate-50/60 text-xs font-semibold leading-[12px] whitespace-nowrap",children:[r.TW," Debt",(0,a.jsx)(M.C,{children:"Interest Bearing Stablecoin"})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(w.c,{className:"mx-1",symbol:r.TW,size:14}),(0,a.jsx)("span",{className:" text-[14px] leading-[14px] font-medium ml-[5px]",children:g})]})]}),(0,ei.Sn)("Bera","Interest Bear",(0,h.Jh)(v[r.O1[l]],10),"Bull","Leverage Bull","".concat(i.toFixed(2),"x"))]})}function LVaultComming(e){let{symbol:s}=e,t="py-5 flex flex-col items-center gap-2 relative dark:border-border border-solid even:border-l even:border-b odd:border-b last:!border-b-0 h-[5.3125rem]";return(0,a.jsxs)("div",{className:(0,h.cn)("card cursor-pointer !p-0 grid grid-cols-2 overflow-hidden order-5",{}),children:[(0,a.jsxs)("div",{className:(0,h.cn)(t,"bg-black/10 dark:bg-white/10"),children:[(0,a.jsx)("div",{className:" text-sm font-semibold whitespace-nowrap",children:s}),(0,a.jsx)("div",{className:"text-[#64748B] dark:text-slate-50/60 text-xs font-medium",children:"-"})]}),(0,a.jsxs)("div",{className:(0,h.cn)(t,"bg-black/10 dark:bg-white/10"),children:[(0,a.jsx)("div",{className:"text-[#64748B] dark:text-slate-50/60 text-xs font-semibold leading-[12px] whitespace-nowrap",children:"Total Deposit"}),(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)("span",{className:" text-[14px] leading-[14px] font-medium ml-[5px]",children:"-"})})]}),(0,a.jsx)("div",{className:(0,h.cn)(t,"col-span-2"),children:(0,a.jsx)("div",{className:"text-xs font-semibold leading-[12px] whitespace-nowrap",children:"New Vault Comming Soon..."})})]})}function LVaultPage(e){var s;let{vc:t,tab:l}=e,{address:n}=(0,y.m)();(0,U.a)({queryKey:["UpdateUserLVault",t,n],queryFn:async()=>!!n&&(await D.w.getState().sliceLVaultsStore.updateUserLVault(t,n),!0)});let i=(0,L.useRouter)(),r=[{tab:"Deposit",content:(0,a.jsx)(LVaultSimpleWrap,{vc:t})},{tab:"Price Trigger Yield",content:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,a.jsx)(PoolCard,{vc:t,type:"buy"}),(0,a.jsx)(PoolCard,{vc:t,type:"sell"})]})},{tab:"Discount Offer",content:(0,a.jsx)(LVaultsDiscount,{vc:t})}],d=(null===(s=r.find(e=>(0,h.pi)(e.tab)==l))||void 0===s?void 0:s.tab)||r[0].tab;return(0,a.jsx)(C.x,{listClassName:"flex-wrap p-0 mb-5 md:gap-14",triggerClassName:'text-lg sm:text-xl md:text-2xl py-0 data-[state="active"]:border-b border-b-black dark:border-b-white leading-[0.8] rounded-none whitespace-nowrap',contentClassName:"gap-5",currentTab:d,onTabChange:e=>(0,er.kQ)(i,t.vault,e),data:r})}function Vaults(){let e=(0,o.p)(),s=r.iK[e]||[],t=(0,L.useSearchParams)(),i=t.get("vault"),d=t.get("tab"),c=s.find(e=>e.vault==i);return(0,F.a1)(),(0,a.jsx)(n.E,{children:(0,a.jsx)("div",{className:"w-full max-w-[1160px] px-4 mx-auto md:pb-8",children:c?(0,a.jsx)(LVaultPage,{vc:c,tab:d}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"page-title",children:"L-Vaults"}),(0,a.jsx)(l.K,{data:"Deposit assets into the Vaults to pair-mint stablecoin and margin token"}),(0,a.jsxs)(E.r,{numItems:1,numItemsMd:2,numItemsLg:3,className:"gap-5 mt-4",children:[s.map((e,s)=>(0,a.jsx)(LVaultCard,{vc:e},"group_vault_item_".concat(s))),(0,a.jsx)(LVaultComming,{symbol:"iRED"})]})]})})})}},67039:function(e,s,t){"use strict";t.d(s,{K:function(){return Noti}});var a=t(52628);t(83508);var l=t(63114);function Noti(e){let{data:s}=e;return(0,a.jsxs)("div",{className:"w-full mt-2 mb-3 md:mt-4 md:mb-6 flex text-[24px] md:text-[14px] text-[#64748B] dark:text-slate-50/60 font-medium leading-[24px] md:leading-[14px]",children:[(0,a.jsx)("div",{className:"",children:(0,a.jsx)(l.pMA,{size:20})}),(0,a.jsx)("div",{className:"text-sm ml-1 ",children:s})]})}},93063:function(e,s,t){"use strict";t.d(s,{BW:function(){return renderToken},Sn:function(){return renderChoseSide},bG:function(){return d},yP:function(){return renderStat}});var a=t(52628),l=t(15493),n=t(2360),i=t(19671),r=t(70475);let d="py-5 flex flex-col items-center gap-2 relative dark:border-border border-solid",renderToken=function(e,s,t){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return(0,a.jsx)("div",{className:(0,l.cn)(d,"border-b",{"border-l":r}),children:(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"text-[#64748B] dark:text-slate-50/60 text-xs font-semibold leading-[12px] whitespace-nowrap flex gap-2 items-center",children:[(0,a.jsx)(i.c,{symbol:e,size:14}),e]}),(0,a.jsxs)("div",{className:"flex mt-2 flex-col gap-1 pl-[1.375rem] text-xs font-medium",children:[(0,a.jsx)("span",{className:"",children:(0,n.d)(s)}),(0,a.jsx)("span",{className:" text-[#64748B] dark:text-slate-50/60",children:"$".concat((0,n.d)(t,2))})]})]})})},renderStat=function(e,s,t){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return(0,a.jsx)("div",{className:(0,l.cn)(d,"border-b pb-10",{"border-l":n}),children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-[#64748B] dark:text-slate-50/60 text-xs font-semibold leading-[12px] whitespace-nowrap text-center",children:e}),(0,a.jsxs)("div",{className:"flex mt-2 items-center gap-2 text-sm font-medium",children:[(0,a.jsx)(i.c,{symbol:s,size:14}),"string"==typeof t?(0,a.jsx)("span",{children:t}):t]})]})})},BtnWrap=e=>{let{children:s,onClick:t,...l}=e;return(0,a.jsx)(r.k6,{hiddenBorder:!0,...l,disabled:!e.onClick,onClick:t,children:s})},renderChoseSide=(e,s,t,n,r,o,c,m)=>(0,a.jsxs)("div",{className:(0,l.cn)(d,"col-span-2 gap-4"),children:[(0,a.jsx)("div",{className:"text-[#64748B] dark:text-slate-50/60 text-xs font-semibold leading-[12px] whitespace-nowrap",children:"Choose your side"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 w-full px-4",children:[(0,a.jsx)(BtnWrap,{className:(0,l.cn)("h-[4.25rem] w-full relative disabled:opacity-100 disabled:cursor-default"),onClick:c,children:(0,a.jsxs)("div",{className:"flex gap-2 items-center p-4 w-full h-[4.25rem] absolute left-0 top-0",children:[(0,a.jsx)(i.c,{symbol:e,size:36}),(0,a.jsxs)("div",{className:"flex flex-col items-start gap-2",children:[(0,a.jsx)("div",{className:"text-white/60 text-xs font-semibold leading-[12px] whitespace-nowrap",children:s}),(0,a.jsx)("span",{className:" text-[14px] leading-[14px] font-medium",children:t})]})]})}),(0,a.jsx)(BtnWrap,{className:(0,l.cn)("h-[4.25rem] w-full relative disabled:opacity-100 disabled:cursor-default"),onClick:m,children:(0,a.jsxs)("div",{className:"flex flex-row-reverse gap-2 items-center p-4 w-full h-[4.25rem] absolute left-0 top-0",children:[(0,a.jsx)(i.c,{symbol:n,size:36}),(0,a.jsxs)("div",{className:"flex flex-col items-end gap-2",children:[(0,a.jsx)("div",{className:"text-white/60 text-xs font-semibold leading-[12px] whitespace-nowrap",children:r}),(0,a.jsx)("span",{className:" text-[14px] leading-[14px] font-medium",children:o})]})]})})]})]})},766:function(e,s,t){"use strict";t.d(s,{Ev:function(){return useLoadBVaults},a1:function(){return useLoadLVaults},g2:function(){return useLoadUserBVaults},tK:function(){return useLoadLntVaults},z2:function(){return useLoadUserLVaults}});var a=t(31480),l=t(6194),n=t(4605),i=t(86026),r=t(64370),d=t(83978),o=t.n(d),c=t(83508),m=t(6951),u=t(90947),x=t(43625);function useLoadLVaults(){let e=(0,u.p)(),s=l.iK[e]||[],{address:t}=(0,m.m)(),a=(0,c.useMemo)(()=>o().chain(l.iK[e]||[]).map(e=>[e.assetTokenAddress,e.xTokenAddress]).flatten().concat([l.O1[e]]).union().value(),[e]);(0,r.a)({queryKey:["UpdateLvautlsTokens",a],queryFn:async()=>(await i.w.getState().sliceTokenStore.updateTokenTotalSupply(a),!0)}),(0,r.a)({queryKey:["UpdateUserLvautlsTokens",a,t],queryFn:async()=>!!t&&(await i.w.getState().sliceTokenStore.updateTokensBalance(a,t),!0)}),(0,r.a)({queryKey:["UpdateLVautls",s],queryFn:async()=>(await i.w.getState().sliceLVaultsStore.updateLVaults(s),!0)})}function useLoadBVaults(){let e=(0,u.p)(),s=(0,c.useMemo)(()=>a.Fw[e].filter(e=>(e.onEnv||[]).includes(n.Vi)),[e,n.Vi]);(0,r.a)({queryKey:["UpdateBVaults",s],queryFn:async()=>(await Promise.all([i.w.getState().sliceBVaultsStore.updateBvaults(s),i.w.getState().sliceBVaultsStore.updateYTokenSythetic(s)]),!0)});let{address:t}=(0,m.m)(),l=(0,c.useMemo)(()=>s.map(e=>[e.asset,e.pToken]).flat().reduce((e,s)=>e.includes(s)?e:[...e,s],[]),[s]);(0,r.a)({queryKey:["UpdateBvautlsTokens",l],queryFn:async()=>(await Promise.all([i.w.getState().sliceTokenStore.updateTokenTotalSupply(l),i.w.getState().sliceTokenStore.updateTokenPrices(l)]),!0),throwOnError:(e,s)=>(console.error(e),!1)}),(0,r.a)({queryKey:["UpdateUserBvautlsTokens",l,t],queryFn:async()=>!!t&&(await i.w.getState().sliceTokenStore.updateTokensBalance(l,t),!0)})}function useLoadLntVaults(){let e=(0,u.p)(),s=(0,c.useMemo)(()=>{var s;return(null===(s=x.f_[e])||void 0===s?void 0:s.filter(e=>(e.onEnv||[]).includes(n.Vi)))||[]},[e,n.Vi]);(0,r.a)({queryKey:["UpdateLntVaults",s],queryFn:async()=>(await i.w.getState().sliceLntVaultsStore.updateLntVaults(s),!0)});let{address:t}=(0,m.m)(),a=(0,c.useMemo)(()=>s.map(e=>[e.vestingToken,e.vToken]).flat().reduce((e,s)=>e.includes(s)?e:[...e,s],[]),[s]);(0,r.a)({queryKey:["UpdateLntvautlsTokens",a],queryFn:async()=>(await i.w.getState().sliceTokenStore.updateTokenTotalSupply(a),await i.w.getState().sliceTokenStore.updateTokenPrices(a),!0),throwOnError:(e,s)=>(console.error(e),!1)}),(0,r.a)({queryKey:["UpdateUserLntvautlsTokens",a,t],queryFn:async()=>!!t&&(await i.w.getState().sliceTokenStore.updateTokensBalance(a,t),!0)})}function useLoadUserLVaults(){let{address:e}=(0,m.m)(),s=(0,u.p)(),t=l.iK[s]||[];(0,r.a)({queryKey:["UpdateAllUserLVaults",s,e,t],queryFn:async()=>!!e&&(await Promise.all(t.map(s=>i.w.getState().sliceLVaultsStore.updateUserLVault(s,e))),!0)})}function useLoadUserBVaults(){let{address:e}=(0,m.m)(),s=(0,u.p)(),t=(0,c.useMemo)(()=>a.Fw[s].filter(e=>(e.onEnv||[]).includes(n.Vi)),[s,n.Vi]),l=(0,i.o)(e=>o().keys(e.sliceBVaultsStore.bvaults).toString(),["sliceBVaultsStore.bvaults"]);(0,r.a)({queryKey:["UpdateAllUserBvaults",t,s,e,l],queryFn:async()=>{if(!e)return!1;let s=i.w.getState().sliceBVaultsStore.bvaults;for(let e of t)if(!s[e.vault])return!1;await Promise.all(t.map(e=>i.w.getState().sliceBVaultsStore.updateEpoches(e)));let getEpochesParams=e=>{let s=i.w.getState().sliceBVaultsStore.bvaults[e.vault],t=[];for(let a=parseInt(s.epochCount.toString());a>0;a--){let s=i.w.getState().sliceBVaultsStore.epoches["".concat(e.vault,"_").concat(a)];t.push(s)}return t};return await Promise.all(t.map(s=>i.w.getState().sliceUserBVaults.updateEpoches(s,e,getEpochesParams(s)))),!0}})}},36437:function(e,s,t){"use strict";t.d(s,{A5:function(){return useTotalSupply},b7:function(){return useNftBalance},ln:function(){return useBalances}});var a=t(15493),l=t(86026);function useBalances(){return(0,l.o)(e=>(0,a.Yb)(e.sliceTokenStore.balances,0n),["sliceTokenStore.balances"])}function useNftBalance(e){return(0,l.o)(s=>s.sliceTokenStore.nftBalance[e]||[],["sliceTokenStore.nftBalance.".concat(e)])}function useTotalSupply(e){return(0,l.o)(s=>{var t;return null!==(t=s.sliceTokenStore.totalSupply[e])&&void 0!==t?t:0n},["sliceTokenStore.totalSupply.".concat(e)])}}},function(e){e.O(0,[7495,4881,5294,7622,3113,6121,6377,7020,4598,9357,8702,8178,4655,6466,2653,2522,1154,3887,4920,170,6026,1396,2710,4787,4225,8179,1744],function(){return e(e.s=95127)}),_N_E=e.O()}]);