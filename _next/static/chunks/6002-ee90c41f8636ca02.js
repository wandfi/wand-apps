"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6002],{99971:function(e,t,a){a.d(t,{c:function(){return CoinIcon}});var n=a(31113),r=a(28070);let s=r.env.NEXT_PUBLIC_BASE_PATH||"";var l=a(26361);let o={BERA:"BERA.svg",balance:"balance.png",berachain:"berachain.svg",berahub:"berahub.svg",bg_home:"bg_home.svg",blackLine:"blackLine.svg",Bull:"Bull.svg",coin:"coin.png",discord:"discord.png",discount:"discount.png",ETH:"ETH.svg",ethfi:"ethfi.png",ETHx:"ETHx.svg",galxe:"galxe.png",gift:"gift.png",gold:"gold.png",greenCycle:"greenCycle.png",GreenDot:"GreenDot.svg","HONEY-USDC":"HONEY-USDC.svg","USDC-HONEY":"HONEY-USDC.svg","HONEY-WBERA":"HONEY-WBERA.webp","HONEY-WBTC":"HONEY-WBTC.svg","HONEY-WETH":"HONEY-WETH.svg",HONEY:"HONEY.svg",iBGT:"iBGT.webp",iRED:"iRED.svg","logo-alt":"logo-alt.svg",Panda:"Panda.svg",piRED:"piRED.svg","status-green":"status-green.svg","status-red":"status-red.svg",twitter:"twitter.png",USDC:"USDC.svg",USDCx:"USDCx.svg",USDT:"USDT.svg",Venom:"Venom.svg",WBERA:"WBERA.svg",WBTC:"WBTC.svg",WBTCx:"WBTCx.svg",weeth:"weeth.png",weETH:"weETH.svg",weETHx:"weETHx.svg",WETH:"WETH.svg",xBERA:"xBERA.svg",xiBGT:"xiBGT.svg",yiRED:"yiRED.svg",ZUSD:"ZUSD.svg",PToken:"PToken.svg",YToken:"YToken.svg",verio:"verio.svg",vIP:"vIP.svg",pvIP:"PToken.svg",yvIP:"YToken.svg"};function CoinIcon(e){let{symbol:t,size:a=48,url:r,...i}=e,u=o[t],c="".concat(s,"/").concat(u);return t?u||r?(0,n.jsx)("img",{...i,className:(0,l.cn)(i.className),width:a,height:a,src:u?c:r,alt:t}):(0,n.jsxs)("svg",{...i,width:a,height:a,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,n.jsx)("text",{className:"fill-primary/60",width:"20",x:"12",y:"12",textAnchor:"middle",fontSize:12,dominantBaseline:"middle",children:t.slice(0,2)}),(0,n.jsx)("circle",{className:"stroke-primary/60",cx:"12",cy:"12",r:"11.5",strokeWidth:1})]}):null}},68535:function(e,t,a){let n;a.d(t,{l6:function(){return getBvaultEpochYtPrices},_c:function(){return getBvaultsPtSynthetic},cb:function(){return getLntVaultEpochYtPrices},mq:function(){return getLntVaultNftStatByUser},Sr:function(){return getLntVaultsDeposited},ZK:function(){return getNftTokensIdsByUser},LJ:function(){return getTokenPricesBySymbol}});var r=a(35004),s=a(73216),l=a(22139),o=a(44769),i=a(83606);let instance=()=>{let e=s.Af.find(e=>e.id==(0,s.BV)()),t=(l.Sz||null!=e&&e.testnet,"https://story-api.".concat(o.Kh.value));return n&&n.defaults.baseURL===t||(n=i.Z.create({baseURL:t,timeout:1e4,headers:{"Content-Type":"application/json"}})),n};var u={get:async function(e){var t;let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e.startsWith("/auth")){let e=localStorage.getItem("earlyaccess-token");if(!e)throw"Need token";n.headers={...n.headers||{},Authorization:e}}let r=await instance().get(e,{...n,params:a});if(console.info("res:",null==r?void 0:r.data),(null==r?void 0:null===(t=r.data)||void 0===t?void 0:t.code)!==200)throw r.data;return r.data.data},post:async function(e){var t;let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e.startsWith("/auth")){let e=localStorage.getItem("earlyaccess-token");if(!e)throw"Need token";n.headers={...n.headers||{},Authorization:e}}let r=await instance().post(e,a,n);if((null==r?void 0:null===(t=r.data)||void 0===t?void 0:t.code)!==200)throw r.data;return r.data.data}};a(26361);let getBvaultEpochYtPrices=(e,t)=>u.get("/api/bvault/getEpochYTPrices/".concat(e,"/").concat(t)),getLntVaultEpochYtPrices=(e,t)=>u.get("/api/lntvault/getEpochYTPrices/".concat(e,"/").concat(t)),getBvaultsPtSynthetic=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return u.post("/api/bvault/batchGetEpochPtSynthetic",{bvaults:e})},getLntVaultsDeposited=e=>u.post("/api/lntvault/batchNfts",{vaults:e}),getLntVaultNftStatByUser=(e,t)=>u.get("/api/lntvault/".concat(e,"/").concat(t,"/nftstat")),getNftTokensIdsByUser=(e,t)=>u.post("/api/nft/".concat(t,"/tokenIds"),{tokens:e}),getTokenPricesBySymbol=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["IP"];return i.Z.get("https://api.g.alchemy.com/prices/v1/7UXJgo01vxWHLJDk09Y0qZct8Y3zMDbX/tokens/by-symbol?".concat(e.map(e=>"symbols="+e).join("&"))).then(e=>e.data.data.filter(e=>e.prices.length).map(e=>({symbol:e.symbol,price:(0,r.f)(e.prices[0].value)})))}},44020:function(e,t,a){a.d(t,{P:function(){return n}});let n={}},55349:function(e,t,a){a.d(t,{w:function(){return B},o:function(){return useStore}});var n=a(83978),r=a.n(n),s=a(64103),l=a(93108),o=a(38894),i=a(68535),u=a(78403),c=a(73216),d=a(44020),p=a(22139),g=a(26361),v=a(62531);a(87031);var h=a(19757),f=a(58714);let m=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(a,n)=>r().mapValues(e,(e,r)=>e(e=>a({[r]:{...n()[r],...e}}),()=>n()[r],t[r]))}({sliceBVaultsStore:function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},getBvaultLpData=async(e,t)=>{let a=t.asset,[[n,r],s]=await Promise.all([e.readContract({abi:o.hd,address:"0x4Be03f781C497A489E3cB0287833452cA9B9E80B",functionName:"getPoolTokens",args:[d.P[a].poolId]}),e.readContract({abi:o.IB,address:a,functionName:d.P[a].isStable?"getActualSupply":"totalSupply"})]),l=n.findIndex(e=>e==d.P[a].base),i=n.findIndex(e=>e==d.P[a].quote);return{lp:a,vault:t.vault,baseBalance:r[l],quoteBalance:r[i],totalSupply:s}},updateBvaults=async a=>{let n=r().now();console.info("timeStart:updateBvaults",n);let s=(0,u.B)(),[l,i]=await Promise.all([Promise.all(a.map(e=>s.readContract({abi:e.isOld?o.VH:o.Pe,address:e.bQueryAddres,functionName:"queryBVault",args:[e.vault]}).then(t=>({vault:e.vault,item:t})))),c.yg.id==(0,c.BV)()?Promise.all(a.map(e=>{var t;return(null===(t=d.P[e.asset])||void 0===t?void 0:t.poolId)?getBvaultLpData(s,e):Promise.resolve(null)})):Promise.resolve(null)]);console.info("timeEND:updateBvaults",r().now()-n);let v=r().filter(l,e=>null!=e).reduce((e,t)=>({...e,[t.vault]:t.item}),{});if(i){for(let e of i)if(e){let t=v[e.vault];t.lpLiq=t.lockedAssetTotal;let a=t.lpLiq*p.Pq/e.totalSupply;t.lpBase=(0,g.UA)(e.baseBalance*a/p.Pq,d.P[e.lp].baseDecimal),t.lpQuote=(0,g.UA)(e.quoteBalance*a/p.Pq,d.P[e.lp].quoteDecimal)}}return e({bvaults:{...t().bvaults,...v}}),v},updateEpoches=async(a,n)=>{var s;let l=n||r().range(1,parseInt((((null===(s=t().bvaults[a.vault])||void 0===s?void 0:s.epochCount)||0n)+1n).toString())).map(e=>BigInt(e));if(0==l.length)return{};let i=(0,u.B)(),c=await Promise.all(l.map(e=>i.readContract({abi:a.isOld?o.VH:o.Pe,address:a.bQueryAddres,functionName:"queryBVaultEpoch",args:[a.vault,e]}))),d=c.reduce((e,t)=>({...e,["".concat(a.vault,"_").concat(t.epochId.toString())]:t}),{});return e({epoches:{...t().epoches,...d}}),d},updateYTokenSythetic=async a=>{let n=(null==a?void 0:a.map(e=>e.vault))||r().keys(t().bvaults),s=await (0,i._c)(n),l=r().mapValues(s,e=>BigInt(e));return e({yTokenSythetic:{...t().yTokenSythetic,...l}}),l};return{bvaults:{},epoches:{},yTokenSythetic:{},...a,updateBvaults,updateEpoches,updateYTokenSythetic}},sliceLVaultsStore:function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},updateLVaults=async a=>{let n=(0,u.B)();if(0==a.length)return{};let r=await Promise.all(a.map(e=>Promise.all([n.readContract({abi:o.Wn,address:e.vaultQuery,functionName:e.isStable?"getStableVaultState":"getVaultState",args:[e.vault]}),n.readContract({abi:o.WW,address:e.vault,functionName:"assetBalance"}),n.readContract({abi:o.WW,address:e.vault,functionName:"usdTotalSupply"}),n.readContract({abi:o.WW,address:e.vault,functionName:"vaultMode"}),n.readContract({abi:o.WW,address:e.vault,functionName:"paramValue",args:[(0,v.$G)("Y",{size:32})]}),e.ptyPoolBelowAddress?n.readContract({abi:o.aT,address:e.ptyPoolBelowAddress,functionName:"totalStakingBalance"}):Promise.resolve(0n),e.ptyPoolAboveAddress?n.readContract({abi:o.aT,address:e.ptyPoolAboveAddress,functionName:"totalStakingBalance"}):Promise.resolve(0n),e.ptyPoolBelowAddress?n.getBalance({address:e.ptyPoolBelowAddress}):Promise.resolve(0n),n.readContract({abi:o.nq,address:e.assetTokenFeed,functionName:"latestPrice"}),n.readContract({abi:o.WW,address:e.vault,functionName:"paramValue",args:[(0,v.$G)("CircuitBreakPeriod",{size:32})]})]).then(t=>{let[a,n,r,s,l,o,i,u,c,d]=t,g=BigInt(Math.floor(new Date().getTime()/1e3)),v=e.isStable?a.M_USDCx>0n&&a.aar<a.AARS:2==s&&(a.aar>=a.AARC||g-a.AARBelowCircuitBreakerLineTime>d);return{...{...a,isStable:!!e.isStable},assetBalance:n,usbTotalSupply:r,vaultMode:e.isStable?a.aar<a.AARS&&a.M_USDC>0n?2:1:s,Y:l,buyPoolTotalStaking:o,sellPoolTotalStaking:i,buyPoolBalance:u,latestPrice:c*p.Pq/p.pn,CircuitBreakPeriod:d,discountEnable:v}}))),s=r.reduce((e,t,n)=>({...e,[a[n].vault]:t}),{});return e({lvaults:{...t().lvaults,...s}}),s},updateUserLVault=async(a,n)=>{let r=(0,u.B)();if(a.isStable)return;let[s,l,i,c,d,p,g]=await Promise.all([r.readContract({abi:o.aT,address:a.ptyPoolBelowAddress,functionName:"userStakingBalance",args:[n]}),r.readContract({abi:o.aT,address:a.ptyPoolBelowAddress,functionName:"earnedMatchedToken",args:[n]}),r.readContract({abi:o.aT,address:a.ptyPoolBelowAddress,functionName:"earnedStakingYields",args:[n]}).catch(()=>0n),r.readContract({abi:o.aT,address:a.ptyPoolBelowAddress,functionName:"earnedMatchingYields",args:[n]}),r.readContract({abi:o.aT,address:a.ptyPoolAboveAddress,functionName:"userStakingBalance",args:[n]}),r.readContract({abi:o.aT,address:a.ptyPoolAboveAddress,functionName:"earnedMatchedToken",args:[n]}),r.readContract({abi:o.aT,address:a.ptyPoolAboveAddress,functionName:"earnedMatchingYields",args:[n]})]),v={buyPool_userStakingBalance:s,buyPool_earnedMatchedToken:l,buyPool_earnedStakingYields:i,buyPool_earnedMatchingYields:c,sellPool_userStakingBalance:d,sellPool_earnedMatchedToken:p,sellPool_earnedMatchingYields:g};return e({user:{...t().user,[a.vault]:v}}),v};return{lvaults:{},user:{},...a,updateLVaults,updateUserLVault}},sliceLntVaultsStore:function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},updateLntVaults=async a=>{let n=(0,u.B)(),s=await Promise.all(a.map(e=>n.readContract({abi:o.Q3,address:e.queryAddres,functionName:"queryVault",args:[e.vault]}).then(t=>({vault:e.vault,item:t})))),l=await (0,i.Sr)(a.map(e=>e.vault)),c=r().filter(s,e=>null!=e).reduce((e,t)=>({...e,[t.vault]:{...t.item,nftCount:BigInt(l[t.vault]||0)}}),{});return e({vaults:{...t().vaults,...c}}),c},updateEpoches=async(a,n)=>{var s;let l=n||r().range(1,parseInt((((null===(s=t().vaults[a.vault])||void 0===s?void 0:s.epochCount)||0n)+1n).toString())).map(e=>BigInt(e));if(0==l.length)return{};let i=(0,u.B)(),c=await Promise.all(l.map(e=>i.readContract({abi:o.Q3,address:a.queryAddres,functionName:"queryVaultEpoch",args:[a.vault,e]}))),d=c.reduce((e,t)=>({...e,["".concat(a.vault,"_").concat(t.epochId.toString())]:t}),{});return e({epoches:{...t().epoches,...d}}),d},updateUserEpoches=async(a,n)=>{var s;let l=(0,u.B)(),i=r().range(1,parseInt((((null===(s=t().vaults[a.vault])||void 0===s?void 0:s.epochCount)||0n)+1n).toString())).map(e=>BigInt(e));if(i.length>0){let r=await Promise.all(i.map(e=>l.readContract({abi:o.Q3,address:a.queryAddres,functionName:"queryVaultEpochUser",args:[a.vault,e,n]})));return e({userEpoches:{...t().userEpoches,[a.vault]:r}}),r}return[]},updateUserNftStat=async(a,n)=>{let r=await (0,i.mq)(a.vault,n),s=(0,u.B)();if(r.length>0){let n=(await Promise.all(r.map(e=>{let{tokenId:t,stat:n,tx:r}=e;return s.readContract({abi:o.qU,address:a.vault,functionName:"Redeemed"==n?"nftRedeemInfo":"nftDepositInfo",args:[BigInt(t)]}).then(e=>{let t="Redeemed"==n?e.redeemTime:e.depositTime,a=e.claimableTime;return{stat:n,tx:r,nftTokenId:e.nftTokenId,startTime:t,claimableTime:a,claimed:e.claimed}}).catch(e=>null)}))).filter(Boolean);return e({userNftStat:{...t().userNftStat,[a.vault]:n}}),n}return{}};return{vaults:{},epoches:{},userEpoches:{},userNftStat:{},...a,updateLntVaults,updateEpoches,updateUserEpoches,updateUserNftStat}},sliceTokenStore:function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},updateTokenTotalSupply=async a=>{if(0==a.length)return{};let n=(0,u.B)(),r=await Promise.all(a.map(e=>e==h.K8?Promise.resolve(0n):n.readContract({abi:f.Wo,address:e,functionName:"totalSupply"}))),s=r.reduce((e,t,n)=>({...e,[a[n]]:t}),{});return e({totalSupply:{...t().totalSupply,...s}}),s},updateTokensBalance=async(a,n)=>{if(0==a.length)return{};let r=(0,u.B)(),s=await Promise.all(a.map(e=>e==h.K8?r.getBalance({address:n}):r.readContract({abi:f.Wo,address:e,functionName:"balanceOf",args:[n]}))),l=s.reduce((e,t,n)=>({...e,[a[n]]:t}),{});return e({balances:{...t().balances,...l}}),l},updateTokenPrices=async a=>{let n=r().groupBy(a,e=>d.P[e]?"lp":"token"),s=n.lp||[];if(0!==s.length){console.info("mlps;",a,s);let e=(0,c.I$)();e.id===c.A2.id||(e.id,c.yg.id)}let l=await (0,i.LJ)(["IP"]);return l.length&&e({prices:{...t().prices,"0x5267F7eE069CEB3D8F1c760c215569b79d0685aD":l[0].price}}),{}},updateDefTokenList=async()=>{let t={[c.yg.id]:"https://hub.berachain.com/internal-env/defaultTokenList.json",[c.A2.id]:"https://raw.githubusercontent.com/berachain/default-lists/main/src/tokens/bartio/defaultTokenList.json"},a=t[(0,c.BV)()];if(!a)return[];let n=await fetch(a).then(e=>e.json()).then(e=>e.tokens.filter(e=>e.chainId===(0,c.BV)()).map(e=>({symbol:e.symbol,address:e.address,decimals:e.decimals,name:e.name,url:(e.logoURI||"").replace("https://https://","https://")})));return localStorage.setItem("catchedDefTokenList_"+(0,c.BV)(),JSON.stringify(n)),e({defTokenList:n}),n},updateNftBalance=async(a,n)=>{let s=await (0,i.ZK)(a,n),l=r().mapValues(s,e=>e.map(e=>BigInt(e)));return e({nftBalance:{...t().nftBalance,...l}}),{}};return{totalSupply:{},updateTokenTotalSupply,balances:{},updateTokensBalance,prices:{"0x549943e04f40284185054145c6E4e9568C1D3241":p.Pq,"0xFCBD14DC51f0A4d49d5E53C2E0950e0bC26d0Dce":p.Pq},updateTokenPrices,defTokenList:(()=>{try{return JSON.parse(localStorage.getItem("catchedDefTokenList_"+(0,c.BV)())||"[]")}catch(e){return[]}})(),updateDefTokenList,nftBalance:{},updateNftBalance,...a}},sliceUserBVaults:(e,t,a)=>{let updateEpoches=async(a,n,r)=>{let s=r.filter(e=>e.epochId>0n);if(0==s.length)return{};let l=(0,u.B)(),i=await Promise.all(s.map(e=>l.readContract({abi:a.isOld?o.VH:o.Pe,address:a.bQueryAddres,functionName:"queryBVaultEpochUser",args:[a.vault,e.epochId,n]})));return e({epoches:{...t().epoches,[a.vault]:i}}),i};return{epoches:{},...a,updateEpoches,reset:()=>e({epoches:{}})}}},{}),B=(0,l.Ue)(m);function useStore(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[""],a=B();return(0,s.useMemo)(()=>e(a),t.map(e=>e?r().get(a,e):a))}},84944:function(e,t,a){a.d(t,{d:function(){return displayBalance}});var n=a(35057);let displayBalance=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:18;if(!e)return"0";let fmtNumber=e=>e.toLocaleString("en-US",{maximumFractionDigits:t}),r=Number((0,n.b)(e,a)),s=Number((.1**t).toFixed(t));return r>0&&r<s?r<.001?fmtNumber(1e6*r)+"μ":"<"+s:r<0&&r>-s?"≈0":fmtNumber(r)}}}]);