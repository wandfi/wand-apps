(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7400],{79391:function(){},87657:function(e,t,n){"use strict";n.d(t,{Z:function(){return ConnectBtn}});var u=n(52987),a=n(29650),l=n(44726),s=n(87621),o=n(45820);function ConnectBtn(){(0,l.Z)(1024);let{isConnected:e,chainId:t}=(0,s.m)(),n=(0,a.We)();return e?(0,u.jsx)(a.NL,{chainStatus:"none",showBalance:!1}):(0,u.jsx)(o.k6,{className:"mt-0 w-fit",onClick:()=>{var e;return null===(e=n.openConnectModal)||void 0===e?void 0:e.call(n)},children:(0,u.jsx)("span",{className:"font-medium text-sm px-5 whitespace-nowrap",children:"Connect Wallet"})})}},25282:function(e,t,n){"use strict";n.d(t,{C:function(){return Tip}});var u=n(52987),a=n(13854),l=n(52653),s=n(55966);function Tip(e){let{children:t,node:n,className:o,inFlex:r,contentClassName:c}=e,i=document.getElementById("tooltip-root");return t?(0,u.jsx)(l.zt,{children:(0,u.jsxs)(l.fC,{children:[(0,u.jsx)(l.xz,{asChild:!0,onClickCapture:e=>{e.preventDefault(),e.stopPropagation()},children:n?(0,u.jsx)("div",{className:(0,a.cn)("inline-block cursor-default",o),style:{verticalAlign:"text-bottom"},children:n}):(0,u.jsx)("div",{className:(0,a.cn)(r?"flex":"translate-y-[-6%] inline-block"," px-[3px] cursor-default relative",o),children:(0,u.jsx)(s.apP,{className:"inline-block stroke-slate-500"})})}),(0,u.jsx)(l.h_,{container:i,children:(0,u.jsxs)(l.VY,{className:(0,a.cn)("max-w-xs text-sm text-white bg-slate-900 shadow-lg dark:bg-[#333333] rounded-md p-4",c),children:[t,(0,u.jsx)(l.Eh,{})]})})]})}):n}},16549:function(e,t,n){"use strict";n.d(t,{b:function(){return useMemoOfChainId}});var u=n(77317),a=n(99409);function useMemoOfChainId(e){let t=(0,a.p)(),n=(0,u.useRef)({});return(0,u.useMemo)(()=>(n.current[t]||(n.current[t]=e()),n.current[t]),[t])}},86008:function(e,t,n){"use strict";n.d(t,{i:function(){return i},p:function(){return useUpdatePtypoolApy}});var u=n(79999),a=n(96555),l=n(32422),s=n(77317),o=n(13277),r=n(93108),c=n(99409);let i=(0,r.Ue)(e=>({update:e}));function useUpdatePtypoolApy(e){let t=(0,c.p)(),n=u.iK[t]||[],r=(0,l.o)(e=>e.sliceLVaultsStore.lvaults,["sliceLVaultsStore.lvaults"]);(0,s.useEffect)(()=>{console.info("updatePtypoolApy"),null==n||n.forEach(n=>{let l=r[n.vault];if(n.ptyPoolAboveAddress&&l&&l.sellPoolTotalStaking&&i.getState().update({[n.ptyPoolAboveAddress]:{staking:(0,o.v)("0.025",10),matching:0n}}),n.ptyPoolBelowAddress&&l&&l.buyPoolTotalStaking&&!l.isStable){let s=l&&l.sellPoolTotalStaking*e[u.O1[t]],o=s>0n&&l.settingsDecimals>0n?l.M_ETHx*l.Y*e[n.xTokenAddress]*a.Pq/2n/s/l.settingsDecimals**10n:0n;i.getState().update({[n.ptyPoolBelowAddress]:{staking:o*10n**10n/a.Pq,matching:0n}})}})},[n,r,e,t])}},83810:function(e,t,n){"use strict";n.d(t,{D2:function(){return useWandContractRead},uX:function(){return useWandContractReads}}),n(62628);var u=n(83978),a=n.n(u);n(77317);var l=n(7886),s=n(17032),o=n(93108);let r=(0,o.Ue)(e=>({time:a().now(),update:()=>{e({time:a().now()})}}));function useWandContractRead(e){let{time:t}=r();return(0,l.u)({...e,query:{placeholderData:e=>e,refetchOnMount:!1,refetchOnWindowFocus:!1,...e.query||{}},wandtime:t})}function useWandContractReads(e){let{time:t}=r();return(0,s.N)({...e,query:{placeholderData:e=>e,refetchOnMount:!1,refetchOnWindowFocus:!1,...e.query||{}},wandtime:t})}},19504:function(e,t,n){"use strict";n.d(t,{g:function(){return B},A:function(){return FetcherProvider}});var u=n(52987),a=n(79999),l=n(96555),s=n(99409),o=n(77317),r=n(84032),c=n(87958),i=n(41340),p=n(53414),d=n(16549),f=n(86008),S=n(13854),v=n(44100),h=n(79229);let B=(0,o.createContext)({prices:(0,S.Yb)({},0n),usbApr:{apr:0n,aprDecimals:10}}),FetcherProvider=e=>{let{children:t}=e;(0,v.d6)();let n=(0,s.p)();!function(){let{chainId:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,r.m)({chainId:e});o.useMemo(()=>(t&&(p.ON.provider=function(e){var t,n;let{chain:u,transport:a}=e,l={chainId:u.id,name:u.name,ensAddress:null===(n=u.contracts)||void 0===n?void 0:null===(t=n.ensRegistry)||void 0===t?void 0:t.address};return"fallback"===a.type?new c.H(a.transports.map(e=>{let{value:t}=e;return new i.r(null==t?void 0:t.url,l)})):new i.r(a.url,l)}(t)),p.ON.provider),[t])}();let V=(0,d.b)(()=>(0,S.Yb)({[a.O1[n]]:l.Pq},0n));(0,h.$$)(V);let m=(0,h.UM)();return(0,f.p)(V),(0,u.jsx)(B.Provider,{value:{prices:V,usbApr:m},children:t})}},44100:function(e,t,n){"use strict";n.d(t,{OY:function(){return useBvaultTVL},R3:function(){return useUpBVaultForUserAction},RA:function(){return useUserBVaultEpoches},Vw:function(){return useEpochesData},Zd:function(){return useBVaultEpoches},d6:function(){return useResetBVaultsData},gz:function(){return useCalcClaimable},lL:function(){return calcBVaultPTApy},nr:function(){return useBVault},oU:function(){return useBVaultApy},v7:function(){return useBVaultBoost}});var u=n(96555),a=n(99409),l=n(13854),s=n(29293),o=n(83978),r=n.n(o),c=n(77317),i=n(87621),p=n(32422),d=n(81501);function useResetBVaultsData(){let e=(0,a.p)(),{address:t}=(0,i.m)();(0,c.useEffect)(()=>{},[e]),(0,c.useEffect)(()=>{p.w.getState().sliceUserBVaults.reset()},[t])}function useBVault(e){return(0,p.o)(t=>t.sliceBVaultsStore.bvaults[e]||(0,l.Yb)({current:(0,l.Yb)({},0n)},0n),["sliceBVaultsStore.bvaults.".concat(e)])}function useBvaultTVL(e){let t=useBVault(e.vault),n=d.P[e.asset],a=(0,p.o)(e=>e.sliceTokenStore.prices,["sliceTokenStore.prices"]),l=n&&a[n.base]||0n,s=n&&a[n.quote]||0n,o=t.lpBase||0n,r=t.lpQuote||0n,c=o*l/u.Pq,i=r*s/u.Pq,f=c+i;return 0n===f&&(f=(t.lockedAssetTotal||0n)*(a[e.asset]||0n)/u.Pq),[f,c,i]}function useBVaultEpoches(e){return(0,p.o)(t=>{let n=t.sliceBVaultsStore.bvaults[e];if(!n||n.epochCount<=0n)return[];let u=r().range(1,parseInt((n.epochCount+1n).toString())).reverse(),a=t.sliceBVaultsStore.epoches;return u.map(t=>a["".concat(e,"_").concat(t)]).filter(e=>null!=e)},["sliceBVaultsStore.bvaults.".concat(e),"sliceBVaultsStore.epoches"])}function useUserBVaultEpoches(e){return(0,p.o)(t=>t.sliceUserBVaults.epoches[e]||[],["sliceUserBVaults.epoches.".concat(e)])}function useEpochesData(e){let t=useBVaultEpoches(e),n=useUserBVaultEpoches(e);return(0,c.useMemo)(()=>{let e=n.reduce((e,t)=>({...e,[t.epochId.toString()]:t}),{});return t.map(t=>(0,l.Yb)({...t,...e[t.epochId.toString()]||{bribes:[],sBribes:[],aBribes:[]}},0n))},[t,n])}function useCalcClaimable(e){let t=useEpochesData(e);return(0,c.useMemo)(()=>{let e=t.filter(e=>e.claimableAssetBalance&&e.settled);return{ids:e.map(e=>e.epochId),claimable:e.reduce((e,t)=>e+t.claimableAssetBalance,0n)}},[t])}function useBVaultBoost(e){let t=(0,p.o)(()=>(function(e){let t=p.w.getState(),n=t.sliceBVaultsStore.bvaults[e],a=(null==n?void 0:n.current.vaultYTokenBalance)||0n,l=(null==n?void 0:n.Y)||0n,o=l>0n?a*u.Pq/l:0n,r=(null==n?void 0:n.current.yTokenAmountForSwapYT)||0n,c=(null==n?void 0:n.lockedAssetTotal)||0n,i=r>0n?c*u.Pq/r:0n;return console.info("calcBootst:",(0,s.d)(o),(0,s.d)(i)),u.Pq,o})(e),["sliceBVaultsStore.bvaults.".concat(e)]);return[(0,s.d)(t,0),t]}function calcBVaultPTApy(e){let t=p.w.getState(),n=t.sliceBVaultsStore.bvaults[e.vault],a=(0,l.ok)(t.sliceBVaultsStore.yTokenSythetic,[e.vault]),s=0n;return s=e.pTokenV2?n&&n.ptRebaseRate&&n.pTokenTotal?n.ptRebaseRate/u.Pq*u.SH*BigInt(1e10)/n.pTokenTotal/u.Pq:0n:n&&n.current.assetTotalSwapAmount&&a?n.current.assetTotalSwapAmount*u.SH*BigInt(1e10)/a:0n,console.info("apy:",e.vault,s,e.pTokenV2,null==n?void 0:n.ptRebaseRate,null==n?void 0:n.pTokenTotal),s}function useBVaultApy(e){let t=(0,p.o)(()=>calcBVaultPTApy(e),["sliceBVaultsStore.bvaults.".concat(e.vault),"sliceBVaultsStore.yTokenSythetic.".concat(e.vault)]);return[(0,l.Jh)(t,10),t]}function useUpBVaultForUserAction(e,t){let{address:n}=(0,i.m)();return()=>{(0,l.XD)(async()=>{if(null==t||t(),!n)return;await Promise.all([p.w.getState().sliceTokenStore.updateTokensBalance([e.asset,e.pToken],n),p.w.getState().sliceTokenStore.updateTokenTotalSupply([e.asset,e.pToken]),p.w.getState().sliceBVaultsStore.updateBvaults([e]),p.w.getState().sliceBVaultsStore.updateYTokenSythetic([e])]);let u=p.w.getState().sliceBVaultsStore.bvaults[e.vault];await p.w.getState().sliceBVaultsStore.updateEpoches(e,u.epochCount>1n?[u.epochCount,u.epochCount-1n]:[u.epochCount]);let a=[];for(let t=parseInt(u.epochCount.toString());t>0;t--){let n=p.w.getState().sliceBVaultsStore.epoches["".concat(e.vault,"_").concat(t)];a.push(n)}console.info("onUserAction:epoches",a),await p.w.getState().sliceUserBVaults.updateEpoches(e,n,a)},3,1e3)}}},79229:function(e,t,n){"use strict";n.d(t,{$$:function(){return useSetLVaultPrices},UM:function(){return useUSBApr},aS:function(){return useValutsLeverageRatio},hC:function(){return useLVault},hY:function(){return useUserLVault},so:function(){return useUpLVaultOnUserAction},z6:function(){return useVaultLeverageRatio}});var u=n(79999),a=n(96555),l=n(99409),s=n(16549),o=n(13854),r=n(32422),c=n(87621),i=n(53414);let p=(0,o.Yb)({vaultMode:0,discountEnable:!1},0n),d=(0,o.Yb)({},0n);function useLVault(e){return(0,r.o)(t=>t.sliceLVaultsStore.lvaults[e]||p,["sliceLVaultsStore.lvaults.".concat(e)])}function useUserLVault(e){return(0,r.o)(t=>t.sliceLVaultsStore.user[e]||d,["sliceLVaultsStore.user.".concat(e)])}function useVaultLeverageRatio(e){let t=useLVault(e.vault),n=(0,o.pF)(t.aar,t.AARDecimals);return Math.max(0,1+1/(n-1))}function useValutsLeverageRatio(){let e=(0,l.p)(),t=u.iK[e]||[],n=(0,s.b)(()=>(0,o.Yb)({},0)),a=(0,r.o)(e=>e.sliceLVaultsStore.lvaults);return null==t||t.forEach(e=>{let t=a[e.vault],u=t?(0,o.pF)(t.aar,t.AARDecimals):0;n[e.vault]=Math.max(0,1+1/(u-1))}),n}function useSetLVaultPrices(e){var t;let n=(0,r.o)(e=>e.sliceLVaultsStore.lvaults),s=(0,r.o)(e=>e.sliceTokenStore.totalSupply),o=(0,l.p)();null===(t=u.iK[o])||void 0===t||t.forEach(t=>{let l=n[t.vault]||p,r=l.assetBalance,c=l.latestPrice,i=l.usbTotalSupply,d=s[t.xTokenAddress]||0n,f=d>0n&&r>0n&&c>0n&&i>0n&&r*c>i*a.Pq?(r*c-i*a.Pq)/d:0n;e[t.xTokenAddress]=f,e[t.assetTokenAddress]=c,d>0n&&r>0n&&c>0n&&i>0n&&r*c<i*a.Pq&&(e[u.O1[o]]=r*c/i)})}function useUSBApr(){var e;let t=(0,l.p)(),n=(0,r.o)(e=>e.sliceLVaultsStore.lvaults),a=0,s=0n,o=0n;return null===(e=u.iK[t])||void 0===e||e.forEach(e=>{let t=n[e.vault]||p;t.isStable?(s+=t.M_USB_USDC*t.Y*t.aar/10n**t.AARDecimals,o+=t.M_USB_USDC,t.M_USB_USDC>0n&&t.Y>0n&&a++):(s+=t.M_USB_ETH*t.Y,o+=t.M_USB_ETH,t.M_USB_ETH>0n&&t.Y>0n&&a++)}),{apr:o>0n?s/o:0n,aprDecimals:10}}function useUpLVaultOnUserAction(e){let{address:t}=(0,c.m)();return()=>{(0,o.XD)(async()=>{if(!t)return;let n=r.w.getState().sliceLVaultsStore,a=[e.assetTokenAddress,e.xTokenAddress,u.O1[(0,i.BV)()]];await Promise.all([n.updateLVaults([e]),n.updateUserLVault(e,t),r.w.getState().sliceTokenStore.updateTokensBalance(a,t),r.w.getState().sliceTokenStore.updateTokenTotalSupply(a)])},3,1e3).catch(console.error)}}}}]);